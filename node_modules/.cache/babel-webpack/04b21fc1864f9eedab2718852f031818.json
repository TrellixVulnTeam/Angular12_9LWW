{"ast":null,"code":"/*! @azure/msal-common v4.5.1 2021-08-02 */\n'use strict';\n\nimport { __awaiter, __generator } from '../_virtual/_tslib.js';\nimport { AuthToken } from '../account/AuthToken.js';\nimport { TimeUtils } from '../utils/TimeUtils.js';\nimport { UrlString } from '../url/UrlString.js';\nimport { ClientAuthError } from '../error/ClientAuthError.js';\n/*\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License.\r\n */\n\nvar KeyLocation = /*#__PURE__*/(() => {\n  (function (KeyLocation) {\n    KeyLocation[\"SW\"] = \"sw\";\n    KeyLocation[\"UHW\"] = \"uhw\";\n  })(KeyLocation || (KeyLocation = {}));\n\n  return KeyLocation;\n})();\n\nvar PopTokenGenerator = function () {\n  function PopTokenGenerator(cryptoUtils) {\n    this.cryptoUtils = cryptoUtils;\n  }\n\n  PopTokenGenerator.prototype.generateCnf = function (request) {\n    return __awaiter(this, void 0, void 0, function () {\n      var kidThumbprint, reqCnf;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            return [4\n            /*yield*/\n            , this.cryptoUtils.getPublicKeyThumbprint(request)];\n\n          case 1:\n            kidThumbprint = _a.sent();\n            reqCnf = {\n              kid: kidThumbprint,\n              xms_ksl: KeyLocation.SW\n            };\n            return [2\n            /*return*/\n            , this.cryptoUtils.base64Encode(JSON.stringify(reqCnf))];\n        }\n      });\n    });\n  };\n\n  PopTokenGenerator.prototype.signPopToken = function (accessToken, request) {\n    var _a;\n\n    return __awaiter(this, void 0, void 0, function () {\n      var tokenClaims, resourceRequestMethod, resourceRequestUri, shrClaims, resourceUrlString, resourceUrlComponents;\n      return __generator(this, function (_b) {\n        switch (_b.label) {\n          case 0:\n            tokenClaims = AuthToken.extractTokenClaims(accessToken, this.cryptoUtils);\n            resourceRequestMethod = request.resourceRequestMethod, resourceRequestUri = request.resourceRequestUri, shrClaims = request.shrClaims;\n            resourceUrlString = resourceRequestUri ? new UrlString(resourceRequestUri) : undefined;\n            resourceUrlComponents = resourceUrlString === null || resourceUrlString === void 0 ? void 0 : resourceUrlString.getUrlComponents();\n\n            if (!((_a = tokenClaims === null || tokenClaims === void 0 ? void 0 : tokenClaims.cnf) === null || _a === void 0 ? void 0 : _a.kid)) {\n              throw ClientAuthError.createTokenClaimsRequiredError();\n            }\n\n            return [4\n            /*yield*/\n            , this.cryptoUtils.signJwt({\n              at: accessToken,\n              ts: TimeUtils.nowSeconds(),\n              m: resourceRequestMethod === null || resourceRequestMethod === void 0 ? void 0 : resourceRequestMethod.toUpperCase(),\n              u: resourceUrlComponents === null || resourceUrlComponents === void 0 ? void 0 : resourceUrlComponents.HostNameAndPort,\n              nonce: this.cryptoUtils.createNewGuid(),\n              p: resourceUrlComponents === null || resourceUrlComponents === void 0 ? void 0 : resourceUrlComponents.AbsolutePath,\n              q: (resourceUrlComponents === null || resourceUrlComponents === void 0 ? void 0 : resourceUrlComponents.QueryString) ? [[], resourceUrlComponents.QueryString] : undefined,\n              client_claims: shrClaims || undefined\n            }, tokenClaims.cnf.kid)];\n\n          case 1:\n            return [2\n            /*return*/\n            , _b.sent()];\n        }\n      });\n    });\n  };\n\n  return PopTokenGenerator;\n}();\n\nexport { PopTokenGenerator };","map":{"version":3,"sources":["C:/Users/admin/Downloads/igo2-lib-master/igo2-lib-master/node_modules/@azure/msal-common/dist/crypto/PopTokenGenerator.js"],"names":["__awaiter","__generator","AuthToken","TimeUtils","UrlString","ClientAuthError","KeyLocation","PopTokenGenerator","cryptoUtils","prototype","generateCnf","request","kidThumbprint","reqCnf","_a","label","getPublicKeyThumbprint","sent","kid","xms_ksl","SW","base64Encode","JSON","stringify","signPopToken","accessToken","tokenClaims","resourceRequestMethod","resourceRequestUri","shrClaims","resourceUrlString","resourceUrlComponents","_b","extractTokenClaims","undefined","getUrlComponents","cnf","createTokenClaimsRequiredError","signJwt","at","ts","nowSeconds","m","toUpperCase","u","HostNameAndPort","nonce","createNewGuid","p","AbsolutePath","q","QueryString","client_claims"],"mappings":"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","sourcesContent":["/*! @azure/msal-common v4.5.1 2021-08-02 */\n'use strict';\nimport { __awaiter, __generator } from '../_virtual/_tslib.js';\nimport { AuthToken } from '../account/AuthToken.js';\nimport { TimeUtils } from '../utils/TimeUtils.js';\nimport { UrlString } from '../url/UrlString.js';\nimport { ClientAuthError } from '../error/ClientAuthError.js';\n\n/*\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License.\r\n */\r\nvar KeyLocation;\r\n(function (KeyLocation) {\r\n    KeyLocation[\"SW\"] = \"sw\";\r\n    KeyLocation[\"UHW\"] = \"uhw\";\r\n})(KeyLocation || (KeyLocation = {}));\r\nvar PopTokenGenerator = /** @class */ (function () {\r\n    function PopTokenGenerator(cryptoUtils) {\r\n        this.cryptoUtils = cryptoUtils;\r\n    }\r\n    PopTokenGenerator.prototype.generateCnf = function (request) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var kidThumbprint, reqCnf;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0: return [4 /*yield*/, this.cryptoUtils.getPublicKeyThumbprint(request)];\r\n                    case 1:\r\n                        kidThumbprint = _a.sent();\r\n                        reqCnf = {\r\n                            kid: kidThumbprint,\r\n                            xms_ksl: KeyLocation.SW\r\n                        };\r\n                        return [2 /*return*/, this.cryptoUtils.base64Encode(JSON.stringify(reqCnf))];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    PopTokenGenerator.prototype.signPopToken = function (accessToken, request) {\r\n        var _a;\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var tokenClaims, resourceRequestMethod, resourceRequestUri, shrClaims, resourceUrlString, resourceUrlComponents;\r\n            return __generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0:\r\n                        tokenClaims = AuthToken.extractTokenClaims(accessToken, this.cryptoUtils);\r\n                        resourceRequestMethod = request.resourceRequestMethod, resourceRequestUri = request.resourceRequestUri, shrClaims = request.shrClaims;\r\n                        resourceUrlString = (resourceRequestUri) ? new UrlString(resourceRequestUri) : undefined;\r\n                        resourceUrlComponents = resourceUrlString === null || resourceUrlString === void 0 ? void 0 : resourceUrlString.getUrlComponents();\r\n                        if (!((_a = tokenClaims === null || tokenClaims === void 0 ? void 0 : tokenClaims.cnf) === null || _a === void 0 ? void 0 : _a.kid)) {\r\n                            throw ClientAuthError.createTokenClaimsRequiredError();\r\n                        }\r\n                        return [4 /*yield*/, this.cryptoUtils.signJwt({\r\n                                at: accessToken,\r\n                                ts: TimeUtils.nowSeconds(),\r\n                                m: resourceRequestMethod === null || resourceRequestMethod === void 0 ? void 0 : resourceRequestMethod.toUpperCase(),\r\n                                u: resourceUrlComponents === null || resourceUrlComponents === void 0 ? void 0 : resourceUrlComponents.HostNameAndPort,\r\n                                nonce: this.cryptoUtils.createNewGuid(),\r\n                                p: resourceUrlComponents === null || resourceUrlComponents === void 0 ? void 0 : resourceUrlComponents.AbsolutePath,\r\n                                q: (resourceUrlComponents === null || resourceUrlComponents === void 0 ? void 0 : resourceUrlComponents.QueryString) ? [[], resourceUrlComponents.QueryString] : undefined,\r\n                                client_claims: shrClaims || undefined\r\n                            }, tokenClaims.cnf.kid)];\r\n                    case 1: return [2 /*return*/, _b.sent()];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    return PopTokenGenerator;\r\n}());\n\nexport { PopTokenGenerator };\n"]},"metadata":{},"sourceType":"module"}