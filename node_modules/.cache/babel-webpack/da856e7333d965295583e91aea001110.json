{"ast":null,"code":"/**\n * @module ol/interaction/DragAndDrop\n */\n// FIXME should handle all geo-referenced data, not just vector data\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nimport Event from '../events/Event.js';\nimport EventType from '../events/EventType.js';\nimport FormatType from '../format/FormatType.js';\nimport Interaction from './Interaction.js';\nimport { TRUE } from '../functions.js';\nimport { get as getProjection } from '../proj.js';\nimport { listen, unlistenByKey } from '../events.js';\n/**\n * @typedef {Object} Options\n * @property {Array<typeof import(\"../format/Feature.js\").default|import(\"../format/Feature.js\").default>} [formatConstructors] Format constructors\n * (and/or formats pre-constructed with options).\n * @property {import(\"../source/Vector.js\").default} [source] Optional vector source where features will be added.  If a source is provided\n * all existing features will be removed and new features will be added when\n * they are dropped on the target.  If you want to add features to a vector\n * source without removing the existing features (append only), instead of\n * providing the source option listen for the \"addfeatures\" event.\n * @property {import(\"../proj.js\").ProjectionLike} [projection] Target projection. By default, the map's view's projection is used.\n * @property {HTMLElement} [target] The element that is used as the drop target, default is the viewport element.\n */\n\n/**\n * @enum {string}\n */\n\nvar DragAndDropEventType = {\n  /**\n   * Triggered when features are added\n   * @event DragAndDropEvent#addfeatures\n   * @api\n   */\n  ADD_FEATURES: 'addfeatures'\n};\n/**\n * @classdesc\n * Events emitted by {@link module:ol/interaction/DragAndDrop~DragAndDrop} instances are instances\n * of this type.\n */\n\nvar DragAndDropEvent = function (_super) {\n  __extends(DragAndDropEvent, _super);\n  /**\n   * @param {DragAndDropEventType} type Type.\n   * @param {File} file File.\n   * @param {Array<import(\"../Feature.js\").default>} [opt_features] Features.\n   * @param {import(\"../proj/Projection.js\").default} [opt_projection] Projection.\n   */\n\n\n  function DragAndDropEvent(type, file, opt_features, opt_projection) {\n    var _this = _super.call(this, type) || this;\n    /**\n     * The features parsed from dropped data.\n     * @type {Array<import(\"../Feature.js\").FeatureLike>|undefined}\n     * @api\n     */\n\n\n    _this.features = opt_features;\n    /**\n     * The dropped file.\n     * @type {File}\n     * @api\n     */\n\n    _this.file = file;\n    /**\n     * The feature projection.\n     * @type {import(\"../proj/Projection.js\").default|undefined}\n     * @api\n     */\n\n    _this.projection = opt_projection;\n    return _this;\n  }\n\n  return DragAndDropEvent;\n}(Event);\n\nexport { DragAndDropEvent };\n/***\n * @template Return\n * @typedef {import(\"../Observable\").OnSignature<import(\"../Observable\").EventTypes, import(\"../events/Event.js\").default, Return> &\n *   import(\"../Observable\").OnSignature<import(\"../ObjectEventType\").Types|\n *     'change:active', import(\"../Object\").ObjectEvent, Return> &\n *   import(\"../Observable\").OnSignature<'addfeatures', DragAndDropEvent, Return> &\n *   import(\"../Observable\").CombinedOnSignature<import(\"../Observable\").EventTypes|import(\"../ObjectEventType\").Types|\n *     'change:active'|'addfeatures', Return>} DragAndDropOnSignature\n */\n\n/**\n * @classdesc\n * Handles input of vector data by drag and drop.\n *\n * Note that the DragAndDrop interaction uses the TextDecoder() constructor if the supplied\n * combination of formats read both text string and ArrayBuffer sources. Older browsers such\n * as IE which do not support this will need a TextDecoder polyfill to be loaded before use.\n *\n * @api\n *\n * @fires DragAndDropEvent\n */\n\nvar DragAndDrop = function (_super) {\n  __extends(DragAndDrop, _super);\n  /**\n   * @param {Options} [opt_options] Options.\n   */\n\n\n  function DragAndDrop(opt_options) {\n    var _this = this;\n\n    var options = opt_options ? opt_options : {};\n    _this = _super.call(this, {\n      handleEvent: TRUE\n    }) || this;\n    /***\n     * @type {DragAndDropOnSignature<import(\"../events\").EventsKey>}\n     */\n\n    _this.on;\n    /***\n     * @type {DragAndDropOnSignature<import(\"../events\").EventsKey>}\n     */\n\n    _this.once;\n    /***\n     * @type {DragAndDropOnSignature<void>}\n     */\n\n    _this.un;\n    /**\n     * @private\n     * @type {boolean}\n     */\n\n    _this.readAsBuffer_ = false;\n    /**\n     * @private\n     * @type {Array<import(\"../format/Feature.js\").default>}\n     */\n\n    _this.formats_ = [];\n    var formatConstructors = options.formatConstructors ? options.formatConstructors : [];\n\n    for (var i = 0, ii = formatConstructors.length; i < ii; ++i) {\n      var format = formatConstructors[i];\n\n      if (typeof format === 'function') {\n        format = new format();\n      }\n\n      _this.formats_.push(format);\n\n      _this.readAsBuffer_ = _this.readAsBuffer_ || format.getType() === FormatType.ARRAY_BUFFER;\n    }\n    /**\n     * @private\n     * @type {import(\"../proj/Projection.js\").default}\n     */\n\n\n    _this.projection_ = options.projection ? getProjection(options.projection) : null;\n    /**\n     * @private\n     * @type {?Array<import(\"../events.js\").EventsKey>}\n     */\n\n    _this.dropListenKeys_ = null;\n    /**\n     * @private\n     * @type {import(\"../source/Vector.js\").default}\n     */\n\n    _this.source_ = options.source || null;\n    /**\n     * @private\n     * @type {HTMLElement}\n     */\n\n    _this.target = options.target ? options.target : null;\n    return _this;\n  }\n  /**\n   * @param {File} file File.\n   * @param {Event} event Load event.\n   * @private\n   */\n\n\n  DragAndDrop.prototype.handleResult_ = function (file, event) {\n    var result = event.target.result;\n    var map = this.getMap();\n    var projection = this.projection_;\n\n    if (!projection) {\n      var view = map.getView();\n      projection = view.getProjection();\n    }\n\n    var text;\n    var formats = this.formats_;\n\n    for (var i = 0, ii = formats.length; i < ii; ++i) {\n      var format = formats[i];\n      var input = result;\n\n      if (this.readAsBuffer_ && format.getType() !== FormatType.ARRAY_BUFFER) {\n        if (text === undefined) {\n          text = new TextDecoder().decode(result);\n        }\n\n        input = text;\n      }\n\n      var features = this.tryReadFeatures_(format, input, {\n        featureProjection: projection\n      });\n\n      if (features && features.length > 0) {\n        if (this.source_) {\n          this.source_.clear();\n          this.source_.addFeatures(features);\n        }\n\n        this.dispatchEvent(new DragAndDropEvent(DragAndDropEventType.ADD_FEATURES, file, features, projection));\n        break;\n      }\n    }\n  };\n  /**\n   * @private\n   */\n\n\n  DragAndDrop.prototype.registerListeners_ = function () {\n    var map = this.getMap();\n\n    if (map) {\n      var dropArea = this.target ? this.target : map.getViewport();\n      this.dropListenKeys_ = [listen(dropArea, EventType.DROP, this.handleDrop, this), listen(dropArea, EventType.DRAGENTER, this.handleStop, this), listen(dropArea, EventType.DRAGOVER, this.handleStop, this), listen(dropArea, EventType.DROP, this.handleStop, this)];\n    }\n  };\n  /**\n   * Activate or deactivate the interaction.\n   * @param {boolean} active Active.\n   * @observable\n   * @api\n   */\n\n\n  DragAndDrop.prototype.setActive = function (active) {\n    if (!this.getActive() && active) {\n      this.registerListeners_();\n    }\n\n    if (this.getActive() && !active) {\n      this.unregisterListeners_();\n    }\n\n    _super.prototype.setActive.call(this, active);\n  };\n  /**\n   * Remove the interaction from its current map and attach it to the new map.\n   * Subclasses may set up event handlers to get notified about changes to\n   * the map here.\n   * @param {import(\"../PluggableMap.js\").default} map Map.\n   */\n\n\n  DragAndDrop.prototype.setMap = function (map) {\n    this.unregisterListeners_();\n\n    _super.prototype.setMap.call(this, map);\n\n    if (this.getActive()) {\n      this.registerListeners_();\n    }\n  };\n  /**\n   * @param {import(\"../format/Feature.js\").default} format Format.\n   * @param {string} text Text.\n   * @param {import(\"../format/Feature.js\").ReadOptions} options Read options.\n   * @private\n   * @return {Array<import(\"../Feature.js\").default>} Features.\n   */\n\n\n  DragAndDrop.prototype.tryReadFeatures_ = function (format, text, options) {\n    try {\n      return format.readFeatures(text, options);\n    } catch (e) {\n      return null;\n    }\n  };\n  /**\n   * @private\n   */\n\n\n  DragAndDrop.prototype.unregisterListeners_ = function () {\n    if (this.dropListenKeys_) {\n      this.dropListenKeys_.forEach(unlistenByKey);\n      this.dropListenKeys_ = null;\n    }\n  };\n  /**\n   * @param {DragEvent} event Event.\n   */\n\n\n  DragAndDrop.prototype.handleDrop = function (event) {\n    var files = event.dataTransfer.files;\n\n    for (var i = 0, ii = files.length; i < ii; ++i) {\n      var file = files.item(i);\n      var reader = new FileReader();\n      reader.addEventListener(EventType.LOAD, this.handleResult_.bind(this, file));\n\n      if (this.readAsBuffer_) {\n        reader.readAsArrayBuffer(file);\n      } else {\n        reader.readAsText(file);\n      }\n    }\n  };\n  /**\n   * @param {DragEvent} event Event.\n   */\n\n\n  DragAndDrop.prototype.handleStop = function (event) {\n    event.stopPropagation();\n    event.preventDefault();\n    event.dataTransfer.dropEffect = 'copy';\n  };\n\n  return DragAndDrop;\n}(Interaction);\n\nexport default DragAndDrop;","map":{"version":3,"sources":["C:/Users/admin/Downloads/angular/igo2-lib-master/node_modules/ol/interaction/DragAndDrop.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","prototype","hasOwnProperty","call","TypeError","String","__","constructor","create","Event","EventType","FormatType","Interaction","TRUE","get","getProjection","listen","unlistenByKey","DragAndDropEventType","ADD_FEATURES","DragAndDropEvent","_super","type","file","opt_features","opt_projection","_this","features","projection","DragAndDrop","opt_options","options","handleEvent","on","once","un","readAsBuffer_","formats_","formatConstructors","i","ii","length","format","push","getType","ARRAY_BUFFER","projection_","dropListenKeys_","source_","source","target","handleResult_","event","result","map","getMap","view","getView","text","formats","input","undefined","TextDecoder","decode","tryReadFeatures_","featureProjection","clear","addFeatures","dispatchEvent","registerListeners_","dropArea","getViewport","DROP","handleDrop","DRAGENTER","handleStop","DRAGOVER","setActive","active","getActive","unregisterListeners_","setMap","readFeatures","e","forEach","files","dataTransfer","item","reader","FileReader","addEventListener","LOAD","bind","readAsArrayBuffer","readAsText","stopPropagation","preventDefault","dropEffect"],"mappings":"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","sourcesContent":["/**\n * @module ol/interaction/DragAndDrop\n */\n// FIXME should handle all geo-referenced data, not just vector data\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport Event from '../events/Event.js';\nimport EventType from '../events/EventType.js';\nimport FormatType from '../format/FormatType.js';\nimport Interaction from './Interaction.js';\nimport { TRUE } from '../functions.js';\nimport { get as getProjection } from '../proj.js';\nimport { listen, unlistenByKey } from '../events.js';\n/**\n * @typedef {Object} Options\n * @property {Array<typeof import(\"../format/Feature.js\").default|import(\"../format/Feature.js\").default>} [formatConstructors] Format constructors\n * (and/or formats pre-constructed with options).\n * @property {import(\"../source/Vector.js\").default} [source] Optional vector source where features will be added.  If a source is provided\n * all existing features will be removed and new features will be added when\n * they are dropped on the target.  If you want to add features to a vector\n * source without removing the existing features (append only), instead of\n * providing the source option listen for the \"addfeatures\" event.\n * @property {import(\"../proj.js\").ProjectionLike} [projection] Target projection. By default, the map's view's projection is used.\n * @property {HTMLElement} [target] The element that is used as the drop target, default is the viewport element.\n */\n/**\n * @enum {string}\n */\nvar DragAndDropEventType = {\n    /**\n     * Triggered when features are added\n     * @event DragAndDropEvent#addfeatures\n     * @api\n     */\n    ADD_FEATURES: 'addfeatures',\n};\n/**\n * @classdesc\n * Events emitted by {@link module:ol/interaction/DragAndDrop~DragAndDrop} instances are instances\n * of this type.\n */\nvar DragAndDropEvent = /** @class */ (function (_super) {\n    __extends(DragAndDropEvent, _super);\n    /**\n     * @param {DragAndDropEventType} type Type.\n     * @param {File} file File.\n     * @param {Array<import(\"../Feature.js\").default>} [opt_features] Features.\n     * @param {import(\"../proj/Projection.js\").default} [opt_projection] Projection.\n     */\n    function DragAndDropEvent(type, file, opt_features, opt_projection) {\n        var _this = _super.call(this, type) || this;\n        /**\n         * The features parsed from dropped data.\n         * @type {Array<import(\"../Feature.js\").FeatureLike>|undefined}\n         * @api\n         */\n        _this.features = opt_features;\n        /**\n         * The dropped file.\n         * @type {File}\n         * @api\n         */\n        _this.file = file;\n        /**\n         * The feature projection.\n         * @type {import(\"../proj/Projection.js\").default|undefined}\n         * @api\n         */\n        _this.projection = opt_projection;\n        return _this;\n    }\n    return DragAndDropEvent;\n}(Event));\nexport { DragAndDropEvent };\n/***\n * @template Return\n * @typedef {import(\"../Observable\").OnSignature<import(\"../Observable\").EventTypes, import(\"../events/Event.js\").default, Return> &\n *   import(\"../Observable\").OnSignature<import(\"../ObjectEventType\").Types|\n *     'change:active', import(\"../Object\").ObjectEvent, Return> &\n *   import(\"../Observable\").OnSignature<'addfeatures', DragAndDropEvent, Return> &\n *   import(\"../Observable\").CombinedOnSignature<import(\"../Observable\").EventTypes|import(\"../ObjectEventType\").Types|\n *     'change:active'|'addfeatures', Return>} DragAndDropOnSignature\n */\n/**\n * @classdesc\n * Handles input of vector data by drag and drop.\n *\n * Note that the DragAndDrop interaction uses the TextDecoder() constructor if the supplied\n * combination of formats read both text string and ArrayBuffer sources. Older browsers such\n * as IE which do not support this will need a TextDecoder polyfill to be loaded before use.\n *\n * @api\n *\n * @fires DragAndDropEvent\n */\nvar DragAndDrop = /** @class */ (function (_super) {\n    __extends(DragAndDrop, _super);\n    /**\n     * @param {Options} [opt_options] Options.\n     */\n    function DragAndDrop(opt_options) {\n        var _this = this;\n        var options = opt_options ? opt_options : {};\n        _this = _super.call(this, {\n            handleEvent: TRUE,\n        }) || this;\n        /***\n         * @type {DragAndDropOnSignature<import(\"../events\").EventsKey>}\n         */\n        _this.on;\n        /***\n         * @type {DragAndDropOnSignature<import(\"../events\").EventsKey>}\n         */\n        _this.once;\n        /***\n         * @type {DragAndDropOnSignature<void>}\n         */\n        _this.un;\n        /**\n         * @private\n         * @type {boolean}\n         */\n        _this.readAsBuffer_ = false;\n        /**\n         * @private\n         * @type {Array<import(\"../format/Feature.js\").default>}\n         */\n        _this.formats_ = [];\n        var formatConstructors = options.formatConstructors\n            ? options.formatConstructors\n            : [];\n        for (var i = 0, ii = formatConstructors.length; i < ii; ++i) {\n            var format = formatConstructors[i];\n            if (typeof format === 'function') {\n                format = new format();\n            }\n            _this.formats_.push(format);\n            _this.readAsBuffer_ =\n                _this.readAsBuffer_ || format.getType() === FormatType.ARRAY_BUFFER;\n        }\n        /**\n         * @private\n         * @type {import(\"../proj/Projection.js\").default}\n         */\n        _this.projection_ = options.projection\n            ? getProjection(options.projection)\n            : null;\n        /**\n         * @private\n         * @type {?Array<import(\"../events.js\").EventsKey>}\n         */\n        _this.dropListenKeys_ = null;\n        /**\n         * @private\n         * @type {import(\"../source/Vector.js\").default}\n         */\n        _this.source_ = options.source || null;\n        /**\n         * @private\n         * @type {HTMLElement}\n         */\n        _this.target = options.target ? options.target : null;\n        return _this;\n    }\n    /**\n     * @param {File} file File.\n     * @param {Event} event Load event.\n     * @private\n     */\n    DragAndDrop.prototype.handleResult_ = function (file, event) {\n        var result = event.target.result;\n        var map = this.getMap();\n        var projection = this.projection_;\n        if (!projection) {\n            var view = map.getView();\n            projection = view.getProjection();\n        }\n        var text;\n        var formats = this.formats_;\n        for (var i = 0, ii = formats.length; i < ii; ++i) {\n            var format = formats[i];\n            var input = result;\n            if (this.readAsBuffer_ && format.getType() !== FormatType.ARRAY_BUFFER) {\n                if (text === undefined) {\n                    text = new TextDecoder().decode(result);\n                }\n                input = text;\n            }\n            var features = this.tryReadFeatures_(format, input, {\n                featureProjection: projection,\n            });\n            if (features && features.length > 0) {\n                if (this.source_) {\n                    this.source_.clear();\n                    this.source_.addFeatures(features);\n                }\n                this.dispatchEvent(new DragAndDropEvent(DragAndDropEventType.ADD_FEATURES, file, features, projection));\n                break;\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    DragAndDrop.prototype.registerListeners_ = function () {\n        var map = this.getMap();\n        if (map) {\n            var dropArea = this.target ? this.target : map.getViewport();\n            this.dropListenKeys_ = [\n                listen(dropArea, EventType.DROP, this.handleDrop, this),\n                listen(dropArea, EventType.DRAGENTER, this.handleStop, this),\n                listen(dropArea, EventType.DRAGOVER, this.handleStop, this),\n                listen(dropArea, EventType.DROP, this.handleStop, this),\n            ];\n        }\n    };\n    /**\n     * Activate or deactivate the interaction.\n     * @param {boolean} active Active.\n     * @observable\n     * @api\n     */\n    DragAndDrop.prototype.setActive = function (active) {\n        if (!this.getActive() && active) {\n            this.registerListeners_();\n        }\n        if (this.getActive() && !active) {\n            this.unregisterListeners_();\n        }\n        _super.prototype.setActive.call(this, active);\n    };\n    /**\n     * Remove the interaction from its current map and attach it to the new map.\n     * Subclasses may set up event handlers to get notified about changes to\n     * the map here.\n     * @param {import(\"../PluggableMap.js\").default} map Map.\n     */\n    DragAndDrop.prototype.setMap = function (map) {\n        this.unregisterListeners_();\n        _super.prototype.setMap.call(this, map);\n        if (this.getActive()) {\n            this.registerListeners_();\n        }\n    };\n    /**\n     * @param {import(\"../format/Feature.js\").default} format Format.\n     * @param {string} text Text.\n     * @param {import(\"../format/Feature.js\").ReadOptions} options Read options.\n     * @private\n     * @return {Array<import(\"../Feature.js\").default>} Features.\n     */\n    DragAndDrop.prototype.tryReadFeatures_ = function (format, text, options) {\n        try {\n            return (\n            /** @type {Array<import(\"../Feature.js\").default>} */\n            (format.readFeatures(text, options)));\n        }\n        catch (e) {\n            return null;\n        }\n    };\n    /**\n     * @private\n     */\n    DragAndDrop.prototype.unregisterListeners_ = function () {\n        if (this.dropListenKeys_) {\n            this.dropListenKeys_.forEach(unlistenByKey);\n            this.dropListenKeys_ = null;\n        }\n    };\n    /**\n     * @param {DragEvent} event Event.\n     */\n    DragAndDrop.prototype.handleDrop = function (event) {\n        var files = event.dataTransfer.files;\n        for (var i = 0, ii = files.length; i < ii; ++i) {\n            var file = files.item(i);\n            var reader = new FileReader();\n            reader.addEventListener(EventType.LOAD, this.handleResult_.bind(this, file));\n            if (this.readAsBuffer_) {\n                reader.readAsArrayBuffer(file);\n            }\n            else {\n                reader.readAsText(file);\n            }\n        }\n    };\n    /**\n     * @param {DragEvent} event Event.\n     */\n    DragAndDrop.prototype.handleStop = function (event) {\n        event.stopPropagation();\n        event.preventDefault();\n        event.dataTransfer.dropEffect = 'copy';\n    };\n    return DragAndDrop;\n}(Interaction));\nexport default DragAndDrop;\n"]},"metadata":{},"sourceType":"module"}