{"ast":null,"code":"/**\n * @module ol/render/canvas/Immediate\n */\n// FIXME test, especially polygons with holes and multipolygons\n// FIXME need to handle large thick features (where pixel size matters)\n// FIXME add offset and end to ol/geom/flat/transform~transform2D?\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nimport GeometryType from '../../geom/GeometryType.js';\nimport VectorContext from '../VectorContext.js';\nimport { asColorLike } from '../../colorlike.js';\nimport { compose as composeTransform, create as createTransform } from '../../transform.js';\nimport { defaultFillStyle, defaultFont, defaultLineCap, defaultLineDash, defaultLineDashOffset, defaultLineJoin, defaultLineWidth, defaultMiterLimit, defaultStrokeStyle, defaultTextAlign, defaultTextBaseline } from '../canvas.js';\nimport { equals } from '../../array.js';\nimport { intersects } from '../../extent.js';\nimport { transform2D } from '../../geom/flat/transform.js';\nimport { transformGeom2D } from '../../geom/SimpleGeometry.js';\n/**\n * @classdesc\n * A concrete subclass of {@link module:ol/render/VectorContext VectorContext} that implements\n * direct rendering of features and geometries to an HTML5 Canvas context.\n * Instances of this class are created internally by the library and\n * provided to application code as vectorContext member of the\n * {@link module:ol/render/Event~RenderEvent RenderEvent} object associated with postcompose, precompose and\n * render events emitted by layers and maps.\n */\n\nvar CanvasImmediateRenderer = function (_super) {\n  __extends(CanvasImmediateRenderer, _super);\n  /**\n   * @param {CanvasRenderingContext2D} context Context.\n   * @param {number} pixelRatio Pixel ratio.\n   * @param {import(\"../../extent.js\").Extent} extent Extent.\n   * @param {import(\"../../transform.js\").Transform} transform Transform.\n   * @param {number} viewRotation View rotation.\n   * @param {number} [opt_squaredTolerance] Optional squared tolerance for simplification.\n   * @param {import(\"../../proj.js\").TransformFunction} [opt_userTransform] Transform from user to view projection.\n   */\n\n\n  function CanvasImmediateRenderer(context, pixelRatio, extent, transform, viewRotation, opt_squaredTolerance, opt_userTransform) {\n    var _this = _super.call(this) || this;\n    /**\n     * @private\n     * @type {CanvasRenderingContext2D}\n     */\n\n\n    _this.context_ = context;\n    /**\n     * @private\n     * @type {number}\n     */\n\n    _this.pixelRatio_ = pixelRatio;\n    /**\n     * @private\n     * @type {import(\"../../extent.js\").Extent}\n     */\n\n    _this.extent_ = extent;\n    /**\n     * @private\n     * @type {import(\"../../transform.js\").Transform}\n     */\n\n    _this.transform_ = transform;\n    /**\n     * @private\n     * @type {number}\n     */\n\n    _this.viewRotation_ = viewRotation;\n    /**\n     * @private\n     * @type {number}\n     */\n\n    _this.squaredTolerance_ = opt_squaredTolerance;\n    /**\n     * @private\n     * @type {import(\"../../proj.js\").TransformFunction}\n     */\n\n    _this.userTransform_ = opt_userTransform;\n    /**\n     * @private\n     * @type {?import(\"../canvas.js\").FillState}\n     */\n\n    _this.contextFillState_ = null;\n    /**\n     * @private\n     * @type {?import(\"../canvas.js\").StrokeState}\n     */\n\n    _this.contextStrokeState_ = null;\n    /**\n     * @private\n     * @type {?import(\"../canvas.js\").TextState}\n     */\n\n    _this.contextTextState_ = null;\n    /**\n     * @private\n     * @type {?import(\"../canvas.js\").FillState}\n     */\n\n    _this.fillState_ = null;\n    /**\n     * @private\n     * @type {?import(\"../canvas.js\").StrokeState}\n     */\n\n    _this.strokeState_ = null;\n    /**\n     * @private\n     * @type {HTMLCanvasElement|HTMLVideoElement|HTMLImageElement}\n     */\n\n    _this.image_ = null;\n    /**\n     * @private\n     * @type {number}\n     */\n\n    _this.imageAnchorX_ = 0;\n    /**\n     * @private\n     * @type {number}\n     */\n\n    _this.imageAnchorY_ = 0;\n    /**\n     * @private\n     * @type {number}\n     */\n\n    _this.imageHeight_ = 0;\n    /**\n     * @private\n     * @type {number}\n     */\n\n    _this.imageOpacity_ = 0;\n    /**\n     * @private\n     * @type {number}\n     */\n\n    _this.imageOriginX_ = 0;\n    /**\n     * @private\n     * @type {number}\n     */\n\n    _this.imageOriginY_ = 0;\n    /**\n     * @private\n     * @type {boolean}\n     */\n\n    _this.imageRotateWithView_ = false;\n    /**\n     * @private\n     * @type {number}\n     */\n\n    _this.imageRotation_ = 0;\n    /**\n     * @private\n     * @type {import(\"../../size.js\").Size}\n     */\n\n    _this.imageScale_ = [0, 0];\n    /**\n     * @private\n     * @type {number}\n     */\n\n    _this.imageWidth_ = 0;\n    /**\n     * @private\n     * @type {string}\n     */\n\n    _this.text_ = '';\n    /**\n     * @private\n     * @type {number}\n     */\n\n    _this.textOffsetX_ = 0;\n    /**\n     * @private\n     * @type {number}\n     */\n\n    _this.textOffsetY_ = 0;\n    /**\n     * @private\n     * @type {boolean}\n     */\n\n    _this.textRotateWithView_ = false;\n    /**\n     * @private\n     * @type {number}\n     */\n\n    _this.textRotation_ = 0;\n    /**\n     * @private\n     * @type {import(\"../../size.js\").Size}\n     */\n\n    _this.textScale_ = [0, 0];\n    /**\n     * @private\n     * @type {?import(\"../canvas.js\").FillState}\n     */\n\n    _this.textFillState_ = null;\n    /**\n     * @private\n     * @type {?import(\"../canvas.js\").StrokeState}\n     */\n\n    _this.textStrokeState_ = null;\n    /**\n     * @private\n     * @type {?import(\"../canvas.js\").TextState}\n     */\n\n    _this.textState_ = null;\n    /**\n     * @private\n     * @type {Array<number>}\n     */\n\n    _this.pixelCoordinates_ = [];\n    /**\n     * @private\n     * @type {import(\"../../transform.js\").Transform}\n     */\n\n    _this.tmpLocalTransform_ = createTransform();\n    return _this;\n  }\n  /**\n   * @param {Array<number>} flatCoordinates Flat coordinates.\n   * @param {number} offset Offset.\n   * @param {number} end End.\n   * @param {number} stride Stride.\n   * @private\n   */\n\n\n  CanvasImmediateRenderer.prototype.drawImages_ = function (flatCoordinates, offset, end, stride) {\n    if (!this.image_) {\n      return;\n    }\n\n    var pixelCoordinates = transform2D(flatCoordinates, offset, end, stride, this.transform_, this.pixelCoordinates_);\n    var context = this.context_;\n    var localTransform = this.tmpLocalTransform_;\n    var alpha = context.globalAlpha;\n\n    if (this.imageOpacity_ != 1) {\n      context.globalAlpha = alpha * this.imageOpacity_;\n    }\n\n    var rotation = this.imageRotation_;\n\n    if (this.imageRotateWithView_) {\n      rotation += this.viewRotation_;\n    }\n\n    for (var i = 0, ii = pixelCoordinates.length; i < ii; i += 2) {\n      var x = pixelCoordinates[i] - this.imageAnchorX_;\n      var y = pixelCoordinates[i + 1] - this.imageAnchorY_;\n\n      if (rotation !== 0 || this.imageScale_[0] != 1 || this.imageScale_[1] != 1) {\n        var centerX = x + this.imageAnchorX_;\n        var centerY = y + this.imageAnchorY_;\n        composeTransform(localTransform, centerX, centerY, 1, 1, rotation, -centerX, -centerY);\n        context.setTransform.apply(context, localTransform);\n        context.translate(centerX, centerY);\n        context.scale(this.imageScale_[0], this.imageScale_[1]);\n        context.drawImage(this.image_, this.imageOriginX_, this.imageOriginY_, this.imageWidth_, this.imageHeight_, -this.imageAnchorX_, -this.imageAnchorY_, this.imageWidth_, this.imageHeight_);\n        context.setTransform(1, 0, 0, 1, 0, 0);\n      } else {\n        context.drawImage(this.image_, this.imageOriginX_, this.imageOriginY_, this.imageWidth_, this.imageHeight_, x, y, this.imageWidth_, this.imageHeight_);\n      }\n    }\n\n    if (this.imageOpacity_ != 1) {\n      context.globalAlpha = alpha;\n    }\n  };\n  /**\n   * @param {Array<number>} flatCoordinates Flat coordinates.\n   * @param {number} offset Offset.\n   * @param {number} end End.\n   * @param {number} stride Stride.\n   * @private\n   */\n\n\n  CanvasImmediateRenderer.prototype.drawText_ = function (flatCoordinates, offset, end, stride) {\n    if (!this.textState_ || this.text_ === '') {\n      return;\n    }\n\n    if (this.textFillState_) {\n      this.setContextFillState_(this.textFillState_);\n    }\n\n    if (this.textStrokeState_) {\n      this.setContextStrokeState_(this.textStrokeState_);\n    }\n\n    this.setContextTextState_(this.textState_);\n    var pixelCoordinates = transform2D(flatCoordinates, offset, end, stride, this.transform_, this.pixelCoordinates_);\n    var context = this.context_;\n    var rotation = this.textRotation_;\n\n    if (this.textRotateWithView_) {\n      rotation += this.viewRotation_;\n    }\n\n    for (; offset < end; offset += stride) {\n      var x = pixelCoordinates[offset] + this.textOffsetX_;\n      var y = pixelCoordinates[offset + 1] + this.textOffsetY_;\n\n      if (rotation !== 0 || this.textScale_[0] != 1 || this.textScale_[1] != 1) {\n        var localTransform = composeTransform(this.tmpLocalTransform_, x, y, 1, 1, rotation, -x, -y);\n        context.setTransform.apply(context, localTransform);\n        context.translate(x, y);\n        context.scale(this.textScale_[0], this.textScale_[1]);\n\n        if (this.textStrokeState_) {\n          context.strokeText(this.text_, 0, 0);\n        }\n\n        if (this.textFillState_) {\n          context.fillText(this.text_, 0, 0);\n        }\n\n        context.setTransform(1, 0, 0, 1, 0, 0);\n      } else {\n        if (this.textStrokeState_) {\n          context.strokeText(this.text_, x, y);\n        }\n\n        if (this.textFillState_) {\n          context.fillText(this.text_, x, y);\n        }\n      }\n    }\n  };\n  /**\n   * @param {Array<number>} flatCoordinates Flat coordinates.\n   * @param {number} offset Offset.\n   * @param {number} end End.\n   * @param {number} stride Stride.\n   * @param {boolean} close Close.\n   * @private\n   * @return {number} end End.\n   */\n\n\n  CanvasImmediateRenderer.prototype.moveToLineTo_ = function (flatCoordinates, offset, end, stride, close) {\n    var context = this.context_;\n    var pixelCoordinates = transform2D(flatCoordinates, offset, end, stride, this.transform_, this.pixelCoordinates_);\n    context.moveTo(pixelCoordinates[0], pixelCoordinates[1]);\n    var length = pixelCoordinates.length;\n\n    if (close) {\n      length -= 2;\n    }\n\n    for (var i = 2; i < length; i += 2) {\n      context.lineTo(pixelCoordinates[i], pixelCoordinates[i + 1]);\n    }\n\n    if (close) {\n      context.closePath();\n    }\n\n    return end;\n  };\n  /**\n   * @param {Array<number>} flatCoordinates Flat coordinates.\n   * @param {number} offset Offset.\n   * @param {Array<number>} ends Ends.\n   * @param {number} stride Stride.\n   * @private\n   * @return {number} End.\n   */\n\n\n  CanvasImmediateRenderer.prototype.drawRings_ = function (flatCoordinates, offset, ends, stride) {\n    for (var i = 0, ii = ends.length; i < ii; ++i) {\n      offset = this.moveToLineTo_(flatCoordinates, offset, ends[i], stride, true);\n    }\n\n    return offset;\n  };\n  /**\n   * Render a circle geometry into the canvas.  Rendering is immediate and uses\n   * the current fill and stroke styles.\n   *\n   * @param {import(\"../../geom/Circle.js\").default} geometry Circle geometry.\n   * @api\n   */\n\n\n  CanvasImmediateRenderer.prototype.drawCircle = function (geometry) {\n    if (!intersects(this.extent_, geometry.getExtent())) {\n      return;\n    }\n\n    if (this.fillState_ || this.strokeState_) {\n      if (this.fillState_) {\n        this.setContextFillState_(this.fillState_);\n      }\n\n      if (this.strokeState_) {\n        this.setContextStrokeState_(this.strokeState_);\n      }\n\n      var pixelCoordinates = transformGeom2D(geometry, this.transform_, this.pixelCoordinates_);\n      var dx = pixelCoordinates[2] - pixelCoordinates[0];\n      var dy = pixelCoordinates[3] - pixelCoordinates[1];\n      var radius = Math.sqrt(dx * dx + dy * dy);\n      var context = this.context_;\n      context.beginPath();\n      context.arc(pixelCoordinates[0], pixelCoordinates[1], radius, 0, 2 * Math.PI);\n\n      if (this.fillState_) {\n        context.fill();\n      }\n\n      if (this.strokeState_) {\n        context.stroke();\n      }\n    }\n\n    if (this.text_ !== '') {\n      this.drawText_(geometry.getCenter(), 0, 2, 2);\n    }\n  };\n  /**\n   * Set the rendering style.  Note that since this is an immediate rendering API,\n   * any `zIndex` on the provided style will be ignored.\n   *\n   * @param {import(\"../../style/Style.js\").default} style The rendering style.\n   * @api\n   */\n\n\n  CanvasImmediateRenderer.prototype.setStyle = function (style) {\n    this.setFillStrokeStyle(style.getFill(), style.getStroke());\n    this.setImageStyle(style.getImage());\n    this.setTextStyle(style.getText());\n  };\n  /**\n   * @param {import(\"../../transform.js\").Transform} transform Transform.\n   */\n\n\n  CanvasImmediateRenderer.prototype.setTransform = function (transform) {\n    this.transform_ = transform;\n  };\n  /**\n   * Render a geometry into the canvas.  Call\n   * {@link module:ol/render/canvas/Immediate~CanvasImmediateRenderer#setStyle renderer.setStyle()} first to set the rendering style.\n   *\n   * @param {import(\"../../geom/Geometry.js\").default|import(\"../Feature.js\").default} geometry The geometry to render.\n   * @api\n   */\n\n\n  CanvasImmediateRenderer.prototype.drawGeometry = function (geometry) {\n    var type = geometry.getType();\n\n    switch (type) {\n      case GeometryType.POINT:\n        this.drawPoint(geometry);\n        break;\n\n      case GeometryType.LINE_STRING:\n        this.drawLineString(geometry);\n        break;\n\n      case GeometryType.POLYGON:\n        this.drawPolygon(geometry);\n        break;\n\n      case GeometryType.MULTI_POINT:\n        this.drawMultiPoint(geometry);\n        break;\n\n      case GeometryType.MULTI_LINE_STRING:\n        this.drawMultiLineString(geometry);\n        break;\n\n      case GeometryType.MULTI_POLYGON:\n        this.drawMultiPolygon(geometry);\n        break;\n\n      case GeometryType.GEOMETRY_COLLECTION:\n        this.drawGeometryCollection(geometry);\n        break;\n\n      case GeometryType.CIRCLE:\n        this.drawCircle(geometry);\n        break;\n\n      default:\n    }\n  };\n  /**\n   * Render a feature into the canvas.  Note that any `zIndex` on the provided\n   * style will be ignored - features are rendered immediately in the order that\n   * this method is called.  If you need `zIndex` support, you should be using an\n   * {@link module:ol/layer/Vector~VectorLayer VectorLayer} instead.\n   *\n   * @param {import(\"../../Feature.js\").default} feature Feature.\n   * @param {import(\"../../style/Style.js\").default} style Style.\n   * @api\n   */\n\n\n  CanvasImmediateRenderer.prototype.drawFeature = function (feature, style) {\n    var geometry = style.getGeometryFunction()(feature);\n\n    if (!geometry || !intersects(this.extent_, geometry.getExtent())) {\n      return;\n    }\n\n    this.setStyle(style);\n    this.drawGeometry(geometry);\n  };\n  /**\n   * Render a GeometryCollection to the canvas.  Rendering is immediate and\n   * uses the current styles appropriate for each geometry in the collection.\n   *\n   * @param {import(\"../../geom/GeometryCollection.js\").default} geometry Geometry collection.\n   */\n\n\n  CanvasImmediateRenderer.prototype.drawGeometryCollection = function (geometry) {\n    var geometries = geometry.getGeometriesArray();\n\n    for (var i = 0, ii = geometries.length; i < ii; ++i) {\n      this.drawGeometry(geometries[i]);\n    }\n  };\n  /**\n   * Render a Point geometry into the canvas.  Rendering is immediate and uses\n   * the current style.\n   *\n   * @param {import(\"../../geom/Point.js\").default|import(\"../Feature.js\").default} geometry Point geometry.\n   */\n\n\n  CanvasImmediateRenderer.prototype.drawPoint = function (geometry) {\n    if (this.squaredTolerance_) {\n      geometry = geometry.simplifyTransformed(this.squaredTolerance_, this.userTransform_);\n    }\n\n    var flatCoordinates = geometry.getFlatCoordinates();\n    var stride = geometry.getStride();\n\n    if (this.image_) {\n      this.drawImages_(flatCoordinates, 0, flatCoordinates.length, stride);\n    }\n\n    if (this.text_ !== '') {\n      this.drawText_(flatCoordinates, 0, flatCoordinates.length, stride);\n    }\n  };\n  /**\n   * Render a MultiPoint geometry  into the canvas.  Rendering is immediate and\n   * uses the current style.\n   *\n   * @param {import(\"../../geom/MultiPoint.js\").default|import(\"../Feature.js\").default} geometry MultiPoint geometry.\n   */\n\n\n  CanvasImmediateRenderer.prototype.drawMultiPoint = function (geometry) {\n    if (this.squaredTolerance_) {\n      geometry = geometry.simplifyTransformed(this.squaredTolerance_, this.userTransform_);\n    }\n\n    var flatCoordinates = geometry.getFlatCoordinates();\n    var stride = geometry.getStride();\n\n    if (this.image_) {\n      this.drawImages_(flatCoordinates, 0, flatCoordinates.length, stride);\n    }\n\n    if (this.text_ !== '') {\n      this.drawText_(flatCoordinates, 0, flatCoordinates.length, stride);\n    }\n  };\n  /**\n   * Render a LineString into the canvas.  Rendering is immediate and uses\n   * the current style.\n   *\n   * @param {import(\"../../geom/LineString.js\").default|import(\"../Feature.js\").default} geometry LineString geometry.\n   */\n\n\n  CanvasImmediateRenderer.prototype.drawLineString = function (geometry) {\n    if (this.squaredTolerance_) {\n      geometry = geometry.simplifyTransformed(this.squaredTolerance_, this.userTransform_);\n    }\n\n    if (!intersects(this.extent_, geometry.getExtent())) {\n      return;\n    }\n\n    if (this.strokeState_) {\n      this.setContextStrokeState_(this.strokeState_);\n      var context = this.context_;\n      var flatCoordinates = geometry.getFlatCoordinates();\n      context.beginPath();\n      this.moveToLineTo_(flatCoordinates, 0, flatCoordinates.length, geometry.getStride(), false);\n      context.stroke();\n    }\n\n    if (this.text_ !== '') {\n      var flatMidpoint = geometry.getFlatMidpoint();\n      this.drawText_(flatMidpoint, 0, 2, 2);\n    }\n  };\n  /**\n   * Render a MultiLineString geometry into the canvas.  Rendering is immediate\n   * and uses the current style.\n   *\n   * @param {import(\"../../geom/MultiLineString.js\").default|import(\"../Feature.js\").default} geometry MultiLineString geometry.\n   */\n\n\n  CanvasImmediateRenderer.prototype.drawMultiLineString = function (geometry) {\n    if (this.squaredTolerance_) {\n      geometry = geometry.simplifyTransformed(this.squaredTolerance_, this.userTransform_);\n    }\n\n    var geometryExtent = geometry.getExtent();\n\n    if (!intersects(this.extent_, geometryExtent)) {\n      return;\n    }\n\n    if (this.strokeState_) {\n      this.setContextStrokeState_(this.strokeState_);\n      var context = this.context_;\n      var flatCoordinates = geometry.getFlatCoordinates();\n      var offset = 0;\n      var ends = geometry.getEnds();\n      var stride = geometry.getStride();\n      context.beginPath();\n\n      for (var i = 0, ii = ends.length; i < ii; ++i) {\n        offset = this.moveToLineTo_(flatCoordinates, offset, ends[i], stride, false);\n      }\n\n      context.stroke();\n    }\n\n    if (this.text_ !== '') {\n      var flatMidpoints = geometry.getFlatMidpoints();\n      this.drawText_(flatMidpoints, 0, flatMidpoints.length, 2);\n    }\n  };\n  /**\n   * Render a Polygon geometry into the canvas.  Rendering is immediate and uses\n   * the current style.\n   *\n   * @param {import(\"../../geom/Polygon.js\").default|import(\"../Feature.js\").default} geometry Polygon geometry.\n   */\n\n\n  CanvasImmediateRenderer.prototype.drawPolygon = function (geometry) {\n    if (this.squaredTolerance_) {\n      geometry = geometry.simplifyTransformed(this.squaredTolerance_, this.userTransform_);\n    }\n\n    if (!intersects(this.extent_, geometry.getExtent())) {\n      return;\n    }\n\n    if (this.strokeState_ || this.fillState_) {\n      if (this.fillState_) {\n        this.setContextFillState_(this.fillState_);\n      }\n\n      if (this.strokeState_) {\n        this.setContextStrokeState_(this.strokeState_);\n      }\n\n      var context = this.context_;\n      context.beginPath();\n      this.drawRings_(geometry.getOrientedFlatCoordinates(), 0, geometry.getEnds(), geometry.getStride());\n\n      if (this.fillState_) {\n        context.fill();\n      }\n\n      if (this.strokeState_) {\n        context.stroke();\n      }\n    }\n\n    if (this.text_ !== '') {\n      var flatInteriorPoint = geometry.getFlatInteriorPoint();\n      this.drawText_(flatInteriorPoint, 0, 2, 2);\n    }\n  };\n  /**\n   * Render MultiPolygon geometry into the canvas.  Rendering is immediate and\n   * uses the current style.\n   * @param {import(\"../../geom/MultiPolygon.js\").default} geometry MultiPolygon geometry.\n   */\n\n\n  CanvasImmediateRenderer.prototype.drawMultiPolygon = function (geometry) {\n    if (this.squaredTolerance_) {\n      geometry = geometry.simplifyTransformed(this.squaredTolerance_, this.userTransform_);\n    }\n\n    if (!intersects(this.extent_, geometry.getExtent())) {\n      return;\n    }\n\n    if (this.strokeState_ || this.fillState_) {\n      if (this.fillState_) {\n        this.setContextFillState_(this.fillState_);\n      }\n\n      if (this.strokeState_) {\n        this.setContextStrokeState_(this.strokeState_);\n      }\n\n      var context = this.context_;\n      var flatCoordinates = geometry.getOrientedFlatCoordinates();\n      var offset = 0;\n      var endss = geometry.getEndss();\n      var stride = geometry.getStride();\n      context.beginPath();\n\n      for (var i = 0, ii = endss.length; i < ii; ++i) {\n        var ends = endss[i];\n        offset = this.drawRings_(flatCoordinates, offset, ends, stride);\n      }\n\n      if (this.fillState_) {\n        context.fill();\n      }\n\n      if (this.strokeState_) {\n        context.stroke();\n      }\n    }\n\n    if (this.text_ !== '') {\n      var flatInteriorPoints = geometry.getFlatInteriorPoints();\n      this.drawText_(flatInteriorPoints, 0, flatInteriorPoints.length, 2);\n    }\n  };\n  /**\n   * @param {import(\"../canvas.js\").FillState} fillState Fill state.\n   * @private\n   */\n\n\n  CanvasImmediateRenderer.prototype.setContextFillState_ = function (fillState) {\n    var context = this.context_;\n    var contextFillState = this.contextFillState_;\n\n    if (!contextFillState) {\n      context.fillStyle = fillState.fillStyle;\n      this.contextFillState_ = {\n        fillStyle: fillState.fillStyle\n      };\n    } else {\n      if (contextFillState.fillStyle != fillState.fillStyle) {\n        contextFillState.fillStyle = fillState.fillStyle;\n        context.fillStyle = fillState.fillStyle;\n      }\n    }\n  };\n  /**\n   * @param {import(\"../canvas.js\").StrokeState} strokeState Stroke state.\n   * @private\n   */\n\n\n  CanvasImmediateRenderer.prototype.setContextStrokeState_ = function (strokeState) {\n    var context = this.context_;\n    var contextStrokeState = this.contextStrokeState_;\n\n    if (!contextStrokeState) {\n      context.lineCap = strokeState.lineCap;\n\n      if (context.setLineDash) {\n        context.setLineDash(strokeState.lineDash);\n        context.lineDashOffset = strokeState.lineDashOffset;\n      }\n\n      context.lineJoin = strokeState.lineJoin;\n      context.lineWidth = strokeState.lineWidth;\n      context.miterLimit = strokeState.miterLimit;\n      context.strokeStyle = strokeState.strokeStyle;\n      this.contextStrokeState_ = {\n        lineCap: strokeState.lineCap,\n        lineDash: strokeState.lineDash,\n        lineDashOffset: strokeState.lineDashOffset,\n        lineJoin: strokeState.lineJoin,\n        lineWidth: strokeState.lineWidth,\n        miterLimit: strokeState.miterLimit,\n        strokeStyle: strokeState.strokeStyle\n      };\n    } else {\n      if (contextStrokeState.lineCap != strokeState.lineCap) {\n        contextStrokeState.lineCap = strokeState.lineCap;\n        context.lineCap = strokeState.lineCap;\n      }\n\n      if (context.setLineDash) {\n        if (!equals(contextStrokeState.lineDash, strokeState.lineDash)) {\n          context.setLineDash(contextStrokeState.lineDash = strokeState.lineDash);\n        }\n\n        if (contextStrokeState.lineDashOffset != strokeState.lineDashOffset) {\n          contextStrokeState.lineDashOffset = strokeState.lineDashOffset;\n          context.lineDashOffset = strokeState.lineDashOffset;\n        }\n      }\n\n      if (contextStrokeState.lineJoin != strokeState.lineJoin) {\n        contextStrokeState.lineJoin = strokeState.lineJoin;\n        context.lineJoin = strokeState.lineJoin;\n      }\n\n      if (contextStrokeState.lineWidth != strokeState.lineWidth) {\n        contextStrokeState.lineWidth = strokeState.lineWidth;\n        context.lineWidth = strokeState.lineWidth;\n      }\n\n      if (contextStrokeState.miterLimit != strokeState.miterLimit) {\n        contextStrokeState.miterLimit = strokeState.miterLimit;\n        context.miterLimit = strokeState.miterLimit;\n      }\n\n      if (contextStrokeState.strokeStyle != strokeState.strokeStyle) {\n        contextStrokeState.strokeStyle = strokeState.strokeStyle;\n        context.strokeStyle = strokeState.strokeStyle;\n      }\n    }\n  };\n  /**\n   * @param {import(\"../canvas.js\").TextState} textState Text state.\n   * @private\n   */\n\n\n  CanvasImmediateRenderer.prototype.setContextTextState_ = function (textState) {\n    var context = this.context_;\n    var contextTextState = this.contextTextState_;\n    var textAlign = textState.textAlign ? textState.textAlign : defaultTextAlign;\n\n    if (!contextTextState) {\n      context.font = textState.font;\n      context.textAlign = textAlign;\n      context.textBaseline = textState.textBaseline;\n      this.contextTextState_ = {\n        font: textState.font,\n        textAlign: textAlign,\n        textBaseline: textState.textBaseline\n      };\n    } else {\n      if (contextTextState.font != textState.font) {\n        contextTextState.font = textState.font;\n        context.font = textState.font;\n      }\n\n      if (contextTextState.textAlign != textAlign) {\n        contextTextState.textAlign = textAlign;\n        context.textAlign = textAlign;\n      }\n\n      if (contextTextState.textBaseline != textState.textBaseline) {\n        contextTextState.textBaseline = textState.textBaseline;\n        context.textBaseline = textState.textBaseline;\n      }\n    }\n  };\n  /**\n   * Set the fill and stroke style for subsequent draw operations.  To clear\n   * either fill or stroke styles, pass null for the appropriate parameter.\n   *\n   * @param {import(\"../../style/Fill.js\").default} fillStyle Fill style.\n   * @param {import(\"../../style/Stroke.js\").default} strokeStyle Stroke style.\n   */\n\n\n  CanvasImmediateRenderer.prototype.setFillStrokeStyle = function (fillStyle, strokeStyle) {\n    var _this = this;\n\n    if (!fillStyle) {\n      this.fillState_ = null;\n    } else {\n      var fillStyleColor = fillStyle.getColor();\n      this.fillState_ = {\n        fillStyle: asColorLike(fillStyleColor ? fillStyleColor : defaultFillStyle)\n      };\n    }\n\n    if (!strokeStyle) {\n      this.strokeState_ = null;\n    } else {\n      var strokeStyleColor = strokeStyle.getColor();\n      var strokeStyleLineCap = strokeStyle.getLineCap();\n      var strokeStyleLineDash = strokeStyle.getLineDash();\n      var strokeStyleLineDashOffset = strokeStyle.getLineDashOffset();\n      var strokeStyleLineJoin = strokeStyle.getLineJoin();\n      var strokeStyleWidth = strokeStyle.getWidth();\n      var strokeStyleMiterLimit = strokeStyle.getMiterLimit();\n      var lineDash = strokeStyleLineDash ? strokeStyleLineDash : defaultLineDash;\n      this.strokeState_ = {\n        lineCap: strokeStyleLineCap !== undefined ? strokeStyleLineCap : defaultLineCap,\n        lineDash: this.pixelRatio_ === 1 ? lineDash : lineDash.map(function (n) {\n          return n * _this.pixelRatio_;\n        }),\n        lineDashOffset: (strokeStyleLineDashOffset ? strokeStyleLineDashOffset : defaultLineDashOffset) * this.pixelRatio_,\n        lineJoin: strokeStyleLineJoin !== undefined ? strokeStyleLineJoin : defaultLineJoin,\n        lineWidth: (strokeStyleWidth !== undefined ? strokeStyleWidth : defaultLineWidth) * this.pixelRatio_,\n        miterLimit: strokeStyleMiterLimit !== undefined ? strokeStyleMiterLimit : defaultMiterLimit,\n        strokeStyle: asColorLike(strokeStyleColor ? strokeStyleColor : defaultStrokeStyle)\n      };\n    }\n  };\n  /**\n   * Set the image style for subsequent draw operations.  Pass null to remove\n   * the image style.\n   *\n   * @param {import(\"../../style/Image.js\").default} imageStyle Image style.\n   */\n\n\n  CanvasImmediateRenderer.prototype.setImageStyle = function (imageStyle) {\n    var imageSize;\n\n    if (!imageStyle || !(imageSize = imageStyle.getSize())) {\n      this.image_ = null;\n      return;\n    }\n\n    var imageAnchor = imageStyle.getAnchor();\n    var imageOrigin = imageStyle.getOrigin();\n    this.image_ = imageStyle.getImage(this.pixelRatio_);\n    this.imageAnchorX_ = imageAnchor[0] * this.pixelRatio_;\n    this.imageAnchorY_ = imageAnchor[1] * this.pixelRatio_;\n    this.imageHeight_ = imageSize[1] * this.pixelRatio_;\n    this.imageOpacity_ = imageStyle.getOpacity();\n    this.imageOriginX_ = imageOrigin[0];\n    this.imageOriginY_ = imageOrigin[1];\n    this.imageRotateWithView_ = imageStyle.getRotateWithView();\n    this.imageRotation_ = imageStyle.getRotation();\n    this.imageScale_ = imageStyle.getScaleArray();\n    this.imageWidth_ = imageSize[0] * this.pixelRatio_;\n  };\n  /**\n   * Set the text style for subsequent draw operations.  Pass null to\n   * remove the text style.\n   *\n   * @param {import(\"../../style/Text.js\").default} textStyle Text style.\n   */\n\n\n  CanvasImmediateRenderer.prototype.setTextStyle = function (textStyle) {\n    if (!textStyle) {\n      this.text_ = '';\n    } else {\n      var textFillStyle = textStyle.getFill();\n\n      if (!textFillStyle) {\n        this.textFillState_ = null;\n      } else {\n        var textFillStyleColor = textFillStyle.getColor();\n        this.textFillState_ = {\n          fillStyle: asColorLike(textFillStyleColor ? textFillStyleColor : defaultFillStyle)\n        };\n      }\n\n      var textStrokeStyle = textStyle.getStroke();\n\n      if (!textStrokeStyle) {\n        this.textStrokeState_ = null;\n      } else {\n        var textStrokeStyleColor = textStrokeStyle.getColor();\n        var textStrokeStyleLineCap = textStrokeStyle.getLineCap();\n        var textStrokeStyleLineDash = textStrokeStyle.getLineDash();\n        var textStrokeStyleLineDashOffset = textStrokeStyle.getLineDashOffset();\n        var textStrokeStyleLineJoin = textStrokeStyle.getLineJoin();\n        var textStrokeStyleWidth = textStrokeStyle.getWidth();\n        var textStrokeStyleMiterLimit = textStrokeStyle.getMiterLimit();\n        this.textStrokeState_ = {\n          lineCap: textStrokeStyleLineCap !== undefined ? textStrokeStyleLineCap : defaultLineCap,\n          lineDash: textStrokeStyleLineDash ? textStrokeStyleLineDash : defaultLineDash,\n          lineDashOffset: textStrokeStyleLineDashOffset ? textStrokeStyleLineDashOffset : defaultLineDashOffset,\n          lineJoin: textStrokeStyleLineJoin !== undefined ? textStrokeStyleLineJoin : defaultLineJoin,\n          lineWidth: textStrokeStyleWidth !== undefined ? textStrokeStyleWidth : defaultLineWidth,\n          miterLimit: textStrokeStyleMiterLimit !== undefined ? textStrokeStyleMiterLimit : defaultMiterLimit,\n          strokeStyle: asColorLike(textStrokeStyleColor ? textStrokeStyleColor : defaultStrokeStyle)\n        };\n      }\n\n      var textFont = textStyle.getFont();\n      var textOffsetX = textStyle.getOffsetX();\n      var textOffsetY = textStyle.getOffsetY();\n      var textRotateWithView = textStyle.getRotateWithView();\n      var textRotation = textStyle.getRotation();\n      var textScale = textStyle.getScaleArray();\n      var textText = textStyle.getText();\n      var textTextAlign = textStyle.getTextAlign();\n      var textTextBaseline = textStyle.getTextBaseline();\n      this.textState_ = {\n        font: textFont !== undefined ? textFont : defaultFont,\n        textAlign: textTextAlign !== undefined ? textTextAlign : defaultTextAlign,\n        textBaseline: textTextBaseline !== undefined ? textTextBaseline : defaultTextBaseline\n      };\n      this.text_ = textText !== undefined ? textText : '';\n      this.textOffsetX_ = textOffsetX !== undefined ? this.pixelRatio_ * textOffsetX : 0;\n      this.textOffsetY_ = textOffsetY !== undefined ? this.pixelRatio_ * textOffsetY : 0;\n      this.textRotateWithView_ = textRotateWithView !== undefined ? textRotateWithView : false;\n      this.textRotation_ = textRotation !== undefined ? textRotation : 0;\n      this.textScale_ = [this.pixelRatio_ * textScale[0], this.pixelRatio_ * textScale[1]];\n    }\n  };\n\n  return CanvasImmediateRenderer;\n}(VectorContext);\n\nexport default CanvasImmediateRenderer;","map":{"version":3,"sources":["C:/Users/admin/Downloads/angular/igo2-lib-master/node_modules/ol/render/canvas/Immediate.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","prototype","hasOwnProperty","call","TypeError","String","__","constructor","create","GeometryType","VectorContext","asColorLike","compose","composeTransform","createTransform","defaultFillStyle","defaultFont","defaultLineCap","defaultLineDash","defaultLineDashOffset","defaultLineJoin","defaultLineWidth","defaultMiterLimit","defaultStrokeStyle","defaultTextAlign","defaultTextBaseline","equals","intersects","transform2D","transformGeom2D","CanvasImmediateRenderer","_super","context","pixelRatio","extent","transform","viewRotation","opt_squaredTolerance","opt_userTransform","_this","context_","pixelRatio_","extent_","transform_","viewRotation_","squaredTolerance_","userTransform_","contextFillState_","contextStrokeState_","contextTextState_","fillState_","strokeState_","image_","imageAnchorX_","imageAnchorY_","imageHeight_","imageOpacity_","imageOriginX_","imageOriginY_","imageRotateWithView_","imageRotation_","imageScale_","imageWidth_","text_","textOffsetX_","textOffsetY_","textRotateWithView_","textRotation_","textScale_","textFillState_","textStrokeState_","textState_","pixelCoordinates_","tmpLocalTransform_","drawImages_","flatCoordinates","offset","end","stride","pixelCoordinates","localTransform","alpha","globalAlpha","rotation","i","ii","length","x","y","centerX","centerY","setTransform","apply","translate","scale","drawImage","drawText_","setContextFillState_","setContextStrokeState_","setContextTextState_","strokeText","fillText","moveToLineTo_","close","moveTo","lineTo","closePath","drawRings_","ends","drawCircle","geometry","getExtent","dx","dy","radius","Math","sqrt","beginPath","arc","PI","fill","stroke","getCenter","setStyle","style","setFillStrokeStyle","getFill","getStroke","setImageStyle","getImage","setTextStyle","getText","drawGeometry","type","getType","POINT","drawPoint","LINE_STRING","drawLineString","POLYGON","drawPolygon","MULTI_POINT","drawMultiPoint","MULTI_LINE_STRING","drawMultiLineString","MULTI_POLYGON","drawMultiPolygon","GEOMETRY_COLLECTION","drawGeometryCollection","CIRCLE","drawFeature","feature","getGeometryFunction","geometries","getGeometriesArray","simplifyTransformed","getFlatCoordinates","getStride","flatMidpoint","getFlatMidpoint","geometryExtent","getEnds","flatMidpoints","getFlatMidpoints","getOrientedFlatCoordinates","flatInteriorPoint","getFlatInteriorPoint","endss","getEndss","flatInteriorPoints","getFlatInteriorPoints","fillState","contextFillState","fillStyle","strokeState","contextStrokeState","lineCap","setLineDash","lineDash","lineDashOffset","lineJoin","lineWidth","miterLimit","strokeStyle","textState","contextTextState","textAlign","font","textBaseline","fillStyleColor","getColor","strokeStyleColor","strokeStyleLineCap","getLineCap","strokeStyleLineDash","getLineDash","strokeStyleLineDashOffset","getLineDashOffset","strokeStyleLineJoin","getLineJoin","strokeStyleWidth","getWidth","strokeStyleMiterLimit","getMiterLimit","undefined","map","n","imageStyle","imageSize","getSize","imageAnchor","getAnchor","imageOrigin","getOrigin","getOpacity","getRotateWithView","getRotation","getScaleArray","textStyle","textFillStyle","textFillStyleColor","textStrokeStyle","textStrokeStyleColor","textStrokeStyleLineCap","textStrokeStyleLineDash","textStrokeStyleLineDashOffset","textStrokeStyleLineJoin","textStrokeStyleWidth","textStrokeStyleMiterLimit","textFont","getFont","textOffsetX","getOffsetX","textOffsetY","getOffsetY","textRotateWithView","textRotation","textScale","textText","textTextAlign","getTextAlign","textTextBaseline","getTextBaseline"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA,IAAIA,SAAS,GAAI,QAAQ,KAAKA,SAAd,IAA6B,YAAY;AACrD,MAAIC,aAAa,GAAG,UAAUC,CAAV,EAAaC,CAAb,EAAgB;AAChCF,IAAAA,aAAa,GAAGG,MAAM,CAACC,cAAP,IACX;AAAEC,MAAAA,SAAS,EAAE;AAAb,iBAA6BC,KAA7B,IAAsC,UAAUL,CAAV,EAAaC,CAAb,EAAgB;AAAED,MAAAA,CAAC,CAACI,SAAF,GAAcH,CAAd;AAAkB,KAD/D,IAEZ,UAAUD,CAAV,EAAaC,CAAb,EAAgB;AAAE,WAAK,IAAIK,CAAT,IAAcL,CAAd,EAAiB,IAAIC,MAAM,CAACK,SAAP,CAAiBC,cAAjB,CAAgCC,IAAhC,CAAqCR,CAArC,EAAwCK,CAAxC,CAAJ,EAAgDN,CAAC,CAACM,CAAD,CAAD,GAAOL,CAAC,CAACK,CAAD,CAAR;AAAc,KAFrG;;AAGA,WAAOP,aAAa,CAACC,CAAD,EAAIC,CAAJ,CAApB;AACH,GALD;;AAMA,SAAO,UAAUD,CAAV,EAAaC,CAAb,EAAgB;AACnB,QAAI,OAAOA,CAAP,KAAa,UAAb,IAA2BA,CAAC,KAAK,IAArC,EACI,MAAM,IAAIS,SAAJ,CAAc,yBAAyBC,MAAM,CAACV,CAAD,CAA/B,GAAqC,+BAAnD,CAAN;AACJF,IAAAA,aAAa,CAACC,CAAD,EAAIC,CAAJ,CAAb;;AACA,aAASW,EAAT,GAAc;AAAE,WAAKC,WAAL,GAAmBb,CAAnB;AAAuB;;AACvCA,IAAAA,CAAC,CAACO,SAAF,GAAcN,CAAC,KAAK,IAAN,GAAaC,MAAM,CAACY,MAAP,CAAcb,CAAd,CAAb,IAAiCW,EAAE,CAACL,SAAH,GAAeN,CAAC,CAACM,SAAjB,EAA4B,IAAIK,EAAJ,EAA7D,CAAd;AACH,GAND;AAOH,CAd2C,EAA5C;;AAeA,OAAOG,YAAP,MAAyB,4BAAzB;AACA,OAAOC,aAAP,MAA0B,qBAA1B;AACA,SAASC,WAAT,QAA4B,oBAA5B;AACA,SAASC,OAAO,IAAIC,gBAApB,EAAsCL,MAAM,IAAIM,eAAhD,QAAwE,oBAAxE;AACA,SAASC,gBAAT,EAA2BC,WAA3B,EAAwCC,cAAxC,EAAwDC,eAAxD,EAAyEC,qBAAzE,EAAgGC,eAAhG,EAAiHC,gBAAjH,EAAmIC,iBAAnI,EAAsJC,kBAAtJ,EAA0KC,gBAA1K,EAA4LC,mBAA5L,QAAwN,cAAxN;AACA,SAASC,MAAT,QAAuB,gBAAvB;AACA,SAASC,UAAT,QAA2B,iBAA3B;AACA,SAASC,WAAT,QAA4B,8BAA5B;AACA,SAASC,eAAT,QAAgC,8BAAhC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,IAAIC,uBAAuB,GAAkB,UAAUC,MAAV,EAAkB;AAC3DvC,EAAAA,SAAS,CAACsC,uBAAD,EAA0BC,MAA1B,CAAT;AACA;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACI,WAASD,uBAAT,CAAiCE,OAAjC,EAA0CC,UAA1C,EAAsDC,MAAtD,EAA8DC,SAA9D,EAAyEC,YAAzE,EAAuFC,oBAAvF,EAA6GC,iBAA7G,EAAgI;AAC5H,QAAIC,KAAK,GAAGR,MAAM,CAAC5B,IAAP,CAAY,IAAZ,KAAqB,IAAjC;AACA;AACR;AACA;AACA;;;AACQoC,IAAAA,KAAK,CAACC,QAAN,GAAiBR,OAAjB;AACA;AACR;AACA;AACA;;AACQO,IAAAA,KAAK,CAACE,WAAN,GAAoBR,UAApB;AACA;AACR;AACA;AACA;;AACQM,IAAAA,KAAK,CAACG,OAAN,GAAgBR,MAAhB;AACA;AACR;AACA;AACA;;AACQK,IAAAA,KAAK,CAACI,UAAN,GAAmBR,SAAnB;AACA;AACR;AACA;AACA;;AACQI,IAAAA,KAAK,CAACK,aAAN,GAAsBR,YAAtB;AACA;AACR;AACA;AACA;;AACQG,IAAAA,KAAK,CAACM,iBAAN,GAA0BR,oBAA1B;AACA;AACR;AACA;AACA;;AACQE,IAAAA,KAAK,CAACO,cAAN,GAAuBR,iBAAvB;AACA;AACR;AACA;AACA;;AACQC,IAAAA,KAAK,CAACQ,iBAAN,GAA0B,IAA1B;AACA;AACR;AACA;AACA;;AACQR,IAAAA,KAAK,CAACS,mBAAN,GAA4B,IAA5B;AACA;AACR;AACA;AACA;;AACQT,IAAAA,KAAK,CAACU,iBAAN,GAA0B,IAA1B;AACA;AACR;AACA;AACA;;AACQV,IAAAA,KAAK,CAACW,UAAN,GAAmB,IAAnB;AACA;AACR;AACA;AACA;;AACQX,IAAAA,KAAK,CAACY,YAAN,GAAqB,IAArB;AACA;AACR;AACA;AACA;;AACQZ,IAAAA,KAAK,CAACa,MAAN,GAAe,IAAf;AACA;AACR;AACA;AACA;;AACQb,IAAAA,KAAK,CAACc,aAAN,GAAsB,CAAtB;AACA;AACR;AACA;AACA;;AACQd,IAAAA,KAAK,CAACe,aAAN,GAAsB,CAAtB;AACA;AACR;AACA;AACA;;AACQf,IAAAA,KAAK,CAACgB,YAAN,GAAqB,CAArB;AACA;AACR;AACA;AACA;;AACQhB,IAAAA,KAAK,CAACiB,aAAN,GAAsB,CAAtB;AACA;AACR;AACA;AACA;;AACQjB,IAAAA,KAAK,CAACkB,aAAN,GAAsB,CAAtB;AACA;AACR;AACA;AACA;;AACQlB,IAAAA,KAAK,CAACmB,aAAN,GAAsB,CAAtB;AACA;AACR;AACA;AACA;;AACQnB,IAAAA,KAAK,CAACoB,oBAAN,GAA6B,KAA7B;AACA;AACR;AACA;AACA;;AACQpB,IAAAA,KAAK,CAACqB,cAAN,GAAuB,CAAvB;AACA;AACR;AACA;AACA;;AACQrB,IAAAA,KAAK,CAACsB,WAAN,GAAoB,CAAC,CAAD,EAAI,CAAJ,CAApB;AACA;AACR;AACA;AACA;;AACQtB,IAAAA,KAAK,CAACuB,WAAN,GAAoB,CAApB;AACA;AACR;AACA;AACA;;AACQvB,IAAAA,KAAK,CAACwB,KAAN,GAAc,EAAd;AACA;AACR;AACA;AACA;;AACQxB,IAAAA,KAAK,CAACyB,YAAN,GAAqB,CAArB;AACA;AACR;AACA;AACA;;AACQzB,IAAAA,KAAK,CAAC0B,YAAN,GAAqB,CAArB;AACA;AACR;AACA;AACA;;AACQ1B,IAAAA,KAAK,CAAC2B,mBAAN,GAA4B,KAA5B;AACA;AACR;AACA;AACA;;AACQ3B,IAAAA,KAAK,CAAC4B,aAAN,GAAsB,CAAtB;AACA;AAC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","sourcesContent":["/**\n * @module ol/render/canvas/Immediate\n */\n// FIXME test, especially polygons with holes and multipolygons\n// FIXME need to handle large thick features (where pixel size matters)\n// FIXME add offset and end to ol/geom/flat/transform~transform2D?\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport GeometryType from '../../geom/GeometryType.js';\nimport VectorContext from '../VectorContext.js';\nimport { asColorLike } from '../../colorlike.js';\nimport { compose as composeTransform, create as createTransform, } from '../../transform.js';\nimport { defaultFillStyle, defaultFont, defaultLineCap, defaultLineDash, defaultLineDashOffset, defaultLineJoin, defaultLineWidth, defaultMiterLimit, defaultStrokeStyle, defaultTextAlign, defaultTextBaseline, } from '../canvas.js';\nimport { equals } from '../../array.js';\nimport { intersects } from '../../extent.js';\nimport { transform2D } from '../../geom/flat/transform.js';\nimport { transformGeom2D } from '../../geom/SimpleGeometry.js';\n/**\n * @classdesc\n * A concrete subclass of {@link module:ol/render/VectorContext VectorContext} that implements\n * direct rendering of features and geometries to an HTML5 Canvas context.\n * Instances of this class are created internally by the library and\n * provided to application code as vectorContext member of the\n * {@link module:ol/render/Event~RenderEvent RenderEvent} object associated with postcompose, precompose and\n * render events emitted by layers and maps.\n */\nvar CanvasImmediateRenderer = /** @class */ (function (_super) {\n    __extends(CanvasImmediateRenderer, _super);\n    /**\n     * @param {CanvasRenderingContext2D} context Context.\n     * @param {number} pixelRatio Pixel ratio.\n     * @param {import(\"../../extent.js\").Extent} extent Extent.\n     * @param {import(\"../../transform.js\").Transform} transform Transform.\n     * @param {number} viewRotation View rotation.\n     * @param {number} [opt_squaredTolerance] Optional squared tolerance for simplification.\n     * @param {import(\"../../proj.js\").TransformFunction} [opt_userTransform] Transform from user to view projection.\n     */\n    function CanvasImmediateRenderer(context, pixelRatio, extent, transform, viewRotation, opt_squaredTolerance, opt_userTransform) {\n        var _this = _super.call(this) || this;\n        /**\n         * @private\n         * @type {CanvasRenderingContext2D}\n         */\n        _this.context_ = context;\n        /**\n         * @private\n         * @type {number}\n         */\n        _this.pixelRatio_ = pixelRatio;\n        /**\n         * @private\n         * @type {import(\"../../extent.js\").Extent}\n         */\n        _this.extent_ = extent;\n        /**\n         * @private\n         * @type {import(\"../../transform.js\").Transform}\n         */\n        _this.transform_ = transform;\n        /**\n         * @private\n         * @type {number}\n         */\n        _this.viewRotation_ = viewRotation;\n        /**\n         * @private\n         * @type {number}\n         */\n        _this.squaredTolerance_ = opt_squaredTolerance;\n        /**\n         * @private\n         * @type {import(\"../../proj.js\").TransformFunction}\n         */\n        _this.userTransform_ = opt_userTransform;\n        /**\n         * @private\n         * @type {?import(\"../canvas.js\").FillState}\n         */\n        _this.contextFillState_ = null;\n        /**\n         * @private\n         * @type {?import(\"../canvas.js\").StrokeState}\n         */\n        _this.contextStrokeState_ = null;\n        /**\n         * @private\n         * @type {?import(\"../canvas.js\").TextState}\n         */\n        _this.contextTextState_ = null;\n        /**\n         * @private\n         * @type {?import(\"../canvas.js\").FillState}\n         */\n        _this.fillState_ = null;\n        /**\n         * @private\n         * @type {?import(\"../canvas.js\").StrokeState}\n         */\n        _this.strokeState_ = null;\n        /**\n         * @private\n         * @type {HTMLCanvasElement|HTMLVideoElement|HTMLImageElement}\n         */\n        _this.image_ = null;\n        /**\n         * @private\n         * @type {number}\n         */\n        _this.imageAnchorX_ = 0;\n        /**\n         * @private\n         * @type {number}\n         */\n        _this.imageAnchorY_ = 0;\n        /**\n         * @private\n         * @type {number}\n         */\n        _this.imageHeight_ = 0;\n        /**\n         * @private\n         * @type {number}\n         */\n        _this.imageOpacity_ = 0;\n        /**\n         * @private\n         * @type {number}\n         */\n        _this.imageOriginX_ = 0;\n        /**\n         * @private\n         * @type {number}\n         */\n        _this.imageOriginY_ = 0;\n        /**\n         * @private\n         * @type {boolean}\n         */\n        _this.imageRotateWithView_ = false;\n        /**\n         * @private\n         * @type {number}\n         */\n        _this.imageRotation_ = 0;\n        /**\n         * @private\n         * @type {import(\"../../size.js\").Size}\n         */\n        _this.imageScale_ = [0, 0];\n        /**\n         * @private\n         * @type {number}\n         */\n        _this.imageWidth_ = 0;\n        /**\n         * @private\n         * @type {string}\n         */\n        _this.text_ = '';\n        /**\n         * @private\n         * @type {number}\n         */\n        _this.textOffsetX_ = 0;\n        /**\n         * @private\n         * @type {number}\n         */\n        _this.textOffsetY_ = 0;\n        /**\n         * @private\n         * @type {boolean}\n         */\n        _this.textRotateWithView_ = false;\n        /**\n         * @private\n         * @type {number}\n         */\n        _this.textRotation_ = 0;\n        /**\n         * @private\n         * @type {import(\"../../size.js\").Size}\n         */\n        _this.textScale_ = [0, 0];\n        /**\n         * @private\n         * @type {?import(\"../canvas.js\").FillState}\n         */\n        _this.textFillState_ = null;\n        /**\n         * @private\n         * @type {?import(\"../canvas.js\").StrokeState}\n         */\n        _this.textStrokeState_ = null;\n        /**\n         * @private\n         * @type {?import(\"../canvas.js\").TextState}\n         */\n        _this.textState_ = null;\n        /**\n         * @private\n         * @type {Array<number>}\n         */\n        _this.pixelCoordinates_ = [];\n        /**\n         * @private\n         * @type {import(\"../../transform.js\").Transform}\n         */\n        _this.tmpLocalTransform_ = createTransform();\n        return _this;\n    }\n    /**\n     * @param {Array<number>} flatCoordinates Flat coordinates.\n     * @param {number} offset Offset.\n     * @param {number} end End.\n     * @param {number} stride Stride.\n     * @private\n     */\n    CanvasImmediateRenderer.prototype.drawImages_ = function (flatCoordinates, offset, end, stride) {\n        if (!this.image_) {\n            return;\n        }\n        var pixelCoordinates = transform2D(flatCoordinates, offset, end, stride, this.transform_, this.pixelCoordinates_);\n        var context = this.context_;\n        var localTransform = this.tmpLocalTransform_;\n        var alpha = context.globalAlpha;\n        if (this.imageOpacity_ != 1) {\n            context.globalAlpha = alpha * this.imageOpacity_;\n        }\n        var rotation = this.imageRotation_;\n        if (this.imageRotateWithView_) {\n            rotation += this.viewRotation_;\n        }\n        for (var i = 0, ii = pixelCoordinates.length; i < ii; i += 2) {\n            var x = pixelCoordinates[i] - this.imageAnchorX_;\n            var y = pixelCoordinates[i + 1] - this.imageAnchorY_;\n            if (rotation !== 0 ||\n                this.imageScale_[0] != 1 ||\n                this.imageScale_[1] != 1) {\n                var centerX = x + this.imageAnchorX_;\n                var centerY = y + this.imageAnchorY_;\n                composeTransform(localTransform, centerX, centerY, 1, 1, rotation, -centerX, -centerY);\n                context.setTransform.apply(context, localTransform);\n                context.translate(centerX, centerY);\n                context.scale(this.imageScale_[0], this.imageScale_[1]);\n                context.drawImage(this.image_, this.imageOriginX_, this.imageOriginY_, this.imageWidth_, this.imageHeight_, -this.imageAnchorX_, -this.imageAnchorY_, this.imageWidth_, this.imageHeight_);\n                context.setTransform(1, 0, 0, 1, 0, 0);\n            }\n            else {\n                context.drawImage(this.image_, this.imageOriginX_, this.imageOriginY_, this.imageWidth_, this.imageHeight_, x, y, this.imageWidth_, this.imageHeight_);\n            }\n        }\n        if (this.imageOpacity_ != 1) {\n            context.globalAlpha = alpha;\n        }\n    };\n    /**\n     * @param {Array<number>} flatCoordinates Flat coordinates.\n     * @param {number} offset Offset.\n     * @param {number} end End.\n     * @param {number} stride Stride.\n     * @private\n     */\n    CanvasImmediateRenderer.prototype.drawText_ = function (flatCoordinates, offset, end, stride) {\n        if (!this.textState_ || this.text_ === '') {\n            return;\n        }\n        if (this.textFillState_) {\n            this.setContextFillState_(this.textFillState_);\n        }\n        if (this.textStrokeState_) {\n            this.setContextStrokeState_(this.textStrokeState_);\n        }\n        this.setContextTextState_(this.textState_);\n        var pixelCoordinates = transform2D(flatCoordinates, offset, end, stride, this.transform_, this.pixelCoordinates_);\n        var context = this.context_;\n        var rotation = this.textRotation_;\n        if (this.textRotateWithView_) {\n            rotation += this.viewRotation_;\n        }\n        for (; offset < end; offset += stride) {\n            var x = pixelCoordinates[offset] + this.textOffsetX_;\n            var y = pixelCoordinates[offset + 1] + this.textOffsetY_;\n            if (rotation !== 0 ||\n                this.textScale_[0] != 1 ||\n                this.textScale_[1] != 1) {\n                var localTransform = composeTransform(this.tmpLocalTransform_, x, y, 1, 1, rotation, -x, -y);\n                context.setTransform.apply(context, localTransform);\n                context.translate(x, y);\n                context.scale(this.textScale_[0], this.textScale_[1]);\n                if (this.textStrokeState_) {\n                    context.strokeText(this.text_, 0, 0);\n                }\n                if (this.textFillState_) {\n                    context.fillText(this.text_, 0, 0);\n                }\n                context.setTransform(1, 0, 0, 1, 0, 0);\n            }\n            else {\n                if (this.textStrokeState_) {\n                    context.strokeText(this.text_, x, y);\n                }\n                if (this.textFillState_) {\n                    context.fillText(this.text_, x, y);\n                }\n            }\n        }\n    };\n    /**\n     * @param {Array<number>} flatCoordinates Flat coordinates.\n     * @param {number} offset Offset.\n     * @param {number} end End.\n     * @param {number} stride Stride.\n     * @param {boolean} close Close.\n     * @private\n     * @return {number} end End.\n     */\n    CanvasImmediateRenderer.prototype.moveToLineTo_ = function (flatCoordinates, offset, end, stride, close) {\n        var context = this.context_;\n        var pixelCoordinates = transform2D(flatCoordinates, offset, end, stride, this.transform_, this.pixelCoordinates_);\n        context.moveTo(pixelCoordinates[0], pixelCoordinates[1]);\n        var length = pixelCoordinates.length;\n        if (close) {\n            length -= 2;\n        }\n        for (var i = 2; i < length; i += 2) {\n            context.lineTo(pixelCoordinates[i], pixelCoordinates[i + 1]);\n        }\n        if (close) {\n            context.closePath();\n        }\n        return end;\n    };\n    /**\n     * @param {Array<number>} flatCoordinates Flat coordinates.\n     * @param {number} offset Offset.\n     * @param {Array<number>} ends Ends.\n     * @param {number} stride Stride.\n     * @private\n     * @return {number} End.\n     */\n    CanvasImmediateRenderer.prototype.drawRings_ = function (flatCoordinates, offset, ends, stride) {\n        for (var i = 0, ii = ends.length; i < ii; ++i) {\n            offset = this.moveToLineTo_(flatCoordinates, offset, ends[i], stride, true);\n        }\n        return offset;\n    };\n    /**\n     * Render a circle geometry into the canvas.  Rendering is immediate and uses\n     * the current fill and stroke styles.\n     *\n     * @param {import(\"../../geom/Circle.js\").default} geometry Circle geometry.\n     * @api\n     */\n    CanvasImmediateRenderer.prototype.drawCircle = function (geometry) {\n        if (!intersects(this.extent_, geometry.getExtent())) {\n            return;\n        }\n        if (this.fillState_ || this.strokeState_) {\n            if (this.fillState_) {\n                this.setContextFillState_(this.fillState_);\n            }\n            if (this.strokeState_) {\n                this.setContextStrokeState_(this.strokeState_);\n            }\n            var pixelCoordinates = transformGeom2D(geometry, this.transform_, this.pixelCoordinates_);\n            var dx = pixelCoordinates[2] - pixelCoordinates[0];\n            var dy = pixelCoordinates[3] - pixelCoordinates[1];\n            var radius = Math.sqrt(dx * dx + dy * dy);\n            var context = this.context_;\n            context.beginPath();\n            context.arc(pixelCoordinates[0], pixelCoordinates[1], radius, 0, 2 * Math.PI);\n            if (this.fillState_) {\n                context.fill();\n            }\n            if (this.strokeState_) {\n                context.stroke();\n            }\n        }\n        if (this.text_ !== '') {\n            this.drawText_(geometry.getCenter(), 0, 2, 2);\n        }\n    };\n    /**\n     * Set the rendering style.  Note that since this is an immediate rendering API,\n     * any `zIndex` on the provided style will be ignored.\n     *\n     * @param {import(\"../../style/Style.js\").default} style The rendering style.\n     * @api\n     */\n    CanvasImmediateRenderer.prototype.setStyle = function (style) {\n        this.setFillStrokeStyle(style.getFill(), style.getStroke());\n        this.setImageStyle(style.getImage());\n        this.setTextStyle(style.getText());\n    };\n    /**\n     * @param {import(\"../../transform.js\").Transform} transform Transform.\n     */\n    CanvasImmediateRenderer.prototype.setTransform = function (transform) {\n        this.transform_ = transform;\n    };\n    /**\n     * Render a geometry into the canvas.  Call\n     * {@link module:ol/render/canvas/Immediate~CanvasImmediateRenderer#setStyle renderer.setStyle()} first to set the rendering style.\n     *\n     * @param {import(\"../../geom/Geometry.js\").default|import(\"../Feature.js\").default} geometry The geometry to render.\n     * @api\n     */\n    CanvasImmediateRenderer.prototype.drawGeometry = function (geometry) {\n        var type = geometry.getType();\n        switch (type) {\n            case GeometryType.POINT:\n                this.drawPoint(\n                /** @type {import(\"../../geom/Point.js\").default} */ (geometry));\n                break;\n            case GeometryType.LINE_STRING:\n                this.drawLineString(\n                /** @type {import(\"../../geom/LineString.js\").default} */ (geometry));\n                break;\n            case GeometryType.POLYGON:\n                this.drawPolygon(\n                /** @type {import(\"../../geom/Polygon.js\").default} */ (geometry));\n                break;\n            case GeometryType.MULTI_POINT:\n                this.drawMultiPoint(\n                /** @type {import(\"../../geom/MultiPoint.js\").default} */ (geometry));\n                break;\n            case GeometryType.MULTI_LINE_STRING:\n                this.drawMultiLineString(\n                /** @type {import(\"../../geom/MultiLineString.js\").default} */ (geometry));\n                break;\n            case GeometryType.MULTI_POLYGON:\n                this.drawMultiPolygon(\n                /** @type {import(\"../../geom/MultiPolygon.js\").default} */ (geometry));\n                break;\n            case GeometryType.GEOMETRY_COLLECTION:\n                this.drawGeometryCollection(\n                /** @type {import(\"../../geom/GeometryCollection.js\").default} */ (geometry));\n                break;\n            case GeometryType.CIRCLE:\n                this.drawCircle(\n                /** @type {import(\"../../geom/Circle.js\").default} */ (geometry));\n                break;\n            default:\n        }\n    };\n    /**\n     * Render a feature into the canvas.  Note that any `zIndex` on the provided\n     * style will be ignored - features are rendered immediately in the order that\n     * this method is called.  If you need `zIndex` support, you should be using an\n     * {@link module:ol/layer/Vector~VectorLayer VectorLayer} instead.\n     *\n     * @param {import(\"../../Feature.js\").default} feature Feature.\n     * @param {import(\"../../style/Style.js\").default} style Style.\n     * @api\n     */\n    CanvasImmediateRenderer.prototype.drawFeature = function (feature, style) {\n        var geometry = style.getGeometryFunction()(feature);\n        if (!geometry || !intersects(this.extent_, geometry.getExtent())) {\n            return;\n        }\n        this.setStyle(style);\n        this.drawGeometry(geometry);\n    };\n    /**\n     * Render a GeometryCollection to the canvas.  Rendering is immediate and\n     * uses the current styles appropriate for each geometry in the collection.\n     *\n     * @param {import(\"../../geom/GeometryCollection.js\").default} geometry Geometry collection.\n     */\n    CanvasImmediateRenderer.prototype.drawGeometryCollection = function (geometry) {\n        var geometries = geometry.getGeometriesArray();\n        for (var i = 0, ii = geometries.length; i < ii; ++i) {\n            this.drawGeometry(geometries[i]);\n        }\n    };\n    /**\n     * Render a Point geometry into the canvas.  Rendering is immediate and uses\n     * the current style.\n     *\n     * @param {import(\"../../geom/Point.js\").default|import(\"../Feature.js\").default} geometry Point geometry.\n     */\n    CanvasImmediateRenderer.prototype.drawPoint = function (geometry) {\n        if (this.squaredTolerance_) {\n            geometry = /** @type {import(\"../../geom/Point.js\").default} */ (geometry.simplifyTransformed(this.squaredTolerance_, this.userTransform_));\n        }\n        var flatCoordinates = geometry.getFlatCoordinates();\n        var stride = geometry.getStride();\n        if (this.image_) {\n            this.drawImages_(flatCoordinates, 0, flatCoordinates.length, stride);\n        }\n        if (this.text_ !== '') {\n            this.drawText_(flatCoordinates, 0, flatCoordinates.length, stride);\n        }\n    };\n    /**\n     * Render a MultiPoint geometry  into the canvas.  Rendering is immediate and\n     * uses the current style.\n     *\n     * @param {import(\"../../geom/MultiPoint.js\").default|import(\"../Feature.js\").default} geometry MultiPoint geometry.\n     */\n    CanvasImmediateRenderer.prototype.drawMultiPoint = function (geometry) {\n        if (this.squaredTolerance_) {\n            geometry = /** @type {import(\"../../geom/MultiPoint.js\").default} */ (geometry.simplifyTransformed(this.squaredTolerance_, this.userTransform_));\n        }\n        var flatCoordinates = geometry.getFlatCoordinates();\n        var stride = geometry.getStride();\n        if (this.image_) {\n            this.drawImages_(flatCoordinates, 0, flatCoordinates.length, stride);\n        }\n        if (this.text_ !== '') {\n            this.drawText_(flatCoordinates, 0, flatCoordinates.length, stride);\n        }\n    };\n    /**\n     * Render a LineString into the canvas.  Rendering is immediate and uses\n     * the current style.\n     *\n     * @param {import(\"../../geom/LineString.js\").default|import(\"../Feature.js\").default} geometry LineString geometry.\n     */\n    CanvasImmediateRenderer.prototype.drawLineString = function (geometry) {\n        if (this.squaredTolerance_) {\n            geometry = /** @type {import(\"../../geom/LineString.js\").default} */ (geometry.simplifyTransformed(this.squaredTolerance_, this.userTransform_));\n        }\n        if (!intersects(this.extent_, geometry.getExtent())) {\n            return;\n        }\n        if (this.strokeState_) {\n            this.setContextStrokeState_(this.strokeState_);\n            var context = this.context_;\n            var flatCoordinates = geometry.getFlatCoordinates();\n            context.beginPath();\n            this.moveToLineTo_(flatCoordinates, 0, flatCoordinates.length, geometry.getStride(), false);\n            context.stroke();\n        }\n        if (this.text_ !== '') {\n            var flatMidpoint = geometry.getFlatMidpoint();\n            this.drawText_(flatMidpoint, 0, 2, 2);\n        }\n    };\n    /**\n     * Render a MultiLineString geometry into the canvas.  Rendering is immediate\n     * and uses the current style.\n     *\n     * @param {import(\"../../geom/MultiLineString.js\").default|import(\"../Feature.js\").default} geometry MultiLineString geometry.\n     */\n    CanvasImmediateRenderer.prototype.drawMultiLineString = function (geometry) {\n        if (this.squaredTolerance_) {\n            geometry =\n                /** @type {import(\"../../geom/MultiLineString.js\").default} */ (geometry.simplifyTransformed(this.squaredTolerance_, this.userTransform_));\n        }\n        var geometryExtent = geometry.getExtent();\n        if (!intersects(this.extent_, geometryExtent)) {\n            return;\n        }\n        if (this.strokeState_) {\n            this.setContextStrokeState_(this.strokeState_);\n            var context = this.context_;\n            var flatCoordinates = geometry.getFlatCoordinates();\n            var offset = 0;\n            var ends = /** @type {Array<number>} */ (geometry.getEnds());\n            var stride = geometry.getStride();\n            context.beginPath();\n            for (var i = 0, ii = ends.length; i < ii; ++i) {\n                offset = this.moveToLineTo_(flatCoordinates, offset, ends[i], stride, false);\n            }\n            context.stroke();\n        }\n        if (this.text_ !== '') {\n            var flatMidpoints = geometry.getFlatMidpoints();\n            this.drawText_(flatMidpoints, 0, flatMidpoints.length, 2);\n        }\n    };\n    /**\n     * Render a Polygon geometry into the canvas.  Rendering is immediate and uses\n     * the current style.\n     *\n     * @param {import(\"../../geom/Polygon.js\").default|import(\"../Feature.js\").default} geometry Polygon geometry.\n     */\n    CanvasImmediateRenderer.prototype.drawPolygon = function (geometry) {\n        if (this.squaredTolerance_) {\n            geometry = /** @type {import(\"../../geom/Polygon.js\").default} */ (geometry.simplifyTransformed(this.squaredTolerance_, this.userTransform_));\n        }\n        if (!intersects(this.extent_, geometry.getExtent())) {\n            return;\n        }\n        if (this.strokeState_ || this.fillState_) {\n            if (this.fillState_) {\n                this.setContextFillState_(this.fillState_);\n            }\n            if (this.strokeState_) {\n                this.setContextStrokeState_(this.strokeState_);\n            }\n            var context = this.context_;\n            context.beginPath();\n            this.drawRings_(geometry.getOrientedFlatCoordinates(), 0, \n            /** @type {Array<number>} */ (geometry.getEnds()), geometry.getStride());\n            if (this.fillState_) {\n                context.fill();\n            }\n            if (this.strokeState_) {\n                context.stroke();\n            }\n        }\n        if (this.text_ !== '') {\n            var flatInteriorPoint = geometry.getFlatInteriorPoint();\n            this.drawText_(flatInteriorPoint, 0, 2, 2);\n        }\n    };\n    /**\n     * Render MultiPolygon geometry into the canvas.  Rendering is immediate and\n     * uses the current style.\n     * @param {import(\"../../geom/MultiPolygon.js\").default} geometry MultiPolygon geometry.\n     */\n    CanvasImmediateRenderer.prototype.drawMultiPolygon = function (geometry) {\n        if (this.squaredTolerance_) {\n            geometry = /** @type {import(\"../../geom/MultiPolygon.js\").default} */ (geometry.simplifyTransformed(this.squaredTolerance_, this.userTransform_));\n        }\n        if (!intersects(this.extent_, geometry.getExtent())) {\n            return;\n        }\n        if (this.strokeState_ || this.fillState_) {\n            if (this.fillState_) {\n                this.setContextFillState_(this.fillState_);\n            }\n            if (this.strokeState_) {\n                this.setContextStrokeState_(this.strokeState_);\n            }\n            var context = this.context_;\n            var flatCoordinates = geometry.getOrientedFlatCoordinates();\n            var offset = 0;\n            var endss = geometry.getEndss();\n            var stride = geometry.getStride();\n            context.beginPath();\n            for (var i = 0, ii = endss.length; i < ii; ++i) {\n                var ends = endss[i];\n                offset = this.drawRings_(flatCoordinates, offset, ends, stride);\n            }\n            if (this.fillState_) {\n                context.fill();\n            }\n            if (this.strokeState_) {\n                context.stroke();\n            }\n        }\n        if (this.text_ !== '') {\n            var flatInteriorPoints = geometry.getFlatInteriorPoints();\n            this.drawText_(flatInteriorPoints, 0, flatInteriorPoints.length, 2);\n        }\n    };\n    /**\n     * @param {import(\"../canvas.js\").FillState} fillState Fill state.\n     * @private\n     */\n    CanvasImmediateRenderer.prototype.setContextFillState_ = function (fillState) {\n        var context = this.context_;\n        var contextFillState = this.contextFillState_;\n        if (!contextFillState) {\n            context.fillStyle = fillState.fillStyle;\n            this.contextFillState_ = {\n                fillStyle: fillState.fillStyle,\n            };\n        }\n        else {\n            if (contextFillState.fillStyle != fillState.fillStyle) {\n                contextFillState.fillStyle = fillState.fillStyle;\n                context.fillStyle = fillState.fillStyle;\n            }\n        }\n    };\n    /**\n     * @param {import(\"../canvas.js\").StrokeState} strokeState Stroke state.\n     * @private\n     */\n    CanvasImmediateRenderer.prototype.setContextStrokeState_ = function (strokeState) {\n        var context = this.context_;\n        var contextStrokeState = this.contextStrokeState_;\n        if (!contextStrokeState) {\n            context.lineCap = strokeState.lineCap;\n            if (context.setLineDash) {\n                context.setLineDash(strokeState.lineDash);\n                context.lineDashOffset = strokeState.lineDashOffset;\n            }\n            context.lineJoin = strokeState.lineJoin;\n            context.lineWidth = strokeState.lineWidth;\n            context.miterLimit = strokeState.miterLimit;\n            context.strokeStyle = strokeState.strokeStyle;\n            this.contextStrokeState_ = {\n                lineCap: strokeState.lineCap,\n                lineDash: strokeState.lineDash,\n                lineDashOffset: strokeState.lineDashOffset,\n                lineJoin: strokeState.lineJoin,\n                lineWidth: strokeState.lineWidth,\n                miterLimit: strokeState.miterLimit,\n                strokeStyle: strokeState.strokeStyle,\n            };\n        }\n        else {\n            if (contextStrokeState.lineCap != strokeState.lineCap) {\n                contextStrokeState.lineCap = strokeState.lineCap;\n                context.lineCap = strokeState.lineCap;\n            }\n            if (context.setLineDash) {\n                if (!equals(contextStrokeState.lineDash, strokeState.lineDash)) {\n                    context.setLineDash((contextStrokeState.lineDash = strokeState.lineDash));\n                }\n                if (contextStrokeState.lineDashOffset != strokeState.lineDashOffset) {\n                    contextStrokeState.lineDashOffset = strokeState.lineDashOffset;\n                    context.lineDashOffset = strokeState.lineDashOffset;\n                }\n            }\n            if (contextStrokeState.lineJoin != strokeState.lineJoin) {\n                contextStrokeState.lineJoin = strokeState.lineJoin;\n                context.lineJoin = strokeState.lineJoin;\n            }\n            if (contextStrokeState.lineWidth != strokeState.lineWidth) {\n                contextStrokeState.lineWidth = strokeState.lineWidth;\n                context.lineWidth = strokeState.lineWidth;\n            }\n            if (contextStrokeState.miterLimit != strokeState.miterLimit) {\n                contextStrokeState.miterLimit = strokeState.miterLimit;\n                context.miterLimit = strokeState.miterLimit;\n            }\n            if (contextStrokeState.strokeStyle != strokeState.strokeStyle) {\n                contextStrokeState.strokeStyle = strokeState.strokeStyle;\n                context.strokeStyle = strokeState.strokeStyle;\n            }\n        }\n    };\n    /**\n     * @param {import(\"../canvas.js\").TextState} textState Text state.\n     * @private\n     */\n    CanvasImmediateRenderer.prototype.setContextTextState_ = function (textState) {\n        var context = this.context_;\n        var contextTextState = this.contextTextState_;\n        var textAlign = textState.textAlign\n            ? textState.textAlign\n            : defaultTextAlign;\n        if (!contextTextState) {\n            context.font = textState.font;\n            context.textAlign = /** @type {CanvasTextAlign} */ (textAlign);\n            context.textBaseline = /** @type {CanvasTextBaseline} */ (textState.textBaseline);\n            this.contextTextState_ = {\n                font: textState.font,\n                textAlign: textAlign,\n                textBaseline: textState.textBaseline,\n            };\n        }\n        else {\n            if (contextTextState.font != textState.font) {\n                contextTextState.font = textState.font;\n                context.font = textState.font;\n            }\n            if (contextTextState.textAlign != textAlign) {\n                contextTextState.textAlign = /** @type {CanvasTextAlign} */ (textAlign);\n                context.textAlign = /** @type {CanvasTextAlign} */ (textAlign);\n            }\n            if (contextTextState.textBaseline != textState.textBaseline) {\n                contextTextState.textBaseline = /** @type {CanvasTextBaseline} */ (textState.textBaseline);\n                context.textBaseline = /** @type {CanvasTextBaseline} */ (textState.textBaseline);\n            }\n        }\n    };\n    /**\n     * Set the fill and stroke style for subsequent draw operations.  To clear\n     * either fill or stroke styles, pass null for the appropriate parameter.\n     *\n     * @param {import(\"../../style/Fill.js\").default} fillStyle Fill style.\n     * @param {import(\"../../style/Stroke.js\").default} strokeStyle Stroke style.\n     */\n    CanvasImmediateRenderer.prototype.setFillStrokeStyle = function (fillStyle, strokeStyle) {\n        var _this = this;\n        if (!fillStyle) {\n            this.fillState_ = null;\n        }\n        else {\n            var fillStyleColor = fillStyle.getColor();\n            this.fillState_ = {\n                fillStyle: asColorLike(fillStyleColor ? fillStyleColor : defaultFillStyle),\n            };\n        }\n        if (!strokeStyle) {\n            this.strokeState_ = null;\n        }\n        else {\n            var strokeStyleColor = strokeStyle.getColor();\n            var strokeStyleLineCap = strokeStyle.getLineCap();\n            var strokeStyleLineDash = strokeStyle.getLineDash();\n            var strokeStyleLineDashOffset = strokeStyle.getLineDashOffset();\n            var strokeStyleLineJoin = strokeStyle.getLineJoin();\n            var strokeStyleWidth = strokeStyle.getWidth();\n            var strokeStyleMiterLimit = strokeStyle.getMiterLimit();\n            var lineDash = strokeStyleLineDash\n                ? strokeStyleLineDash\n                : defaultLineDash;\n            this.strokeState_ = {\n                lineCap: strokeStyleLineCap !== undefined\n                    ? strokeStyleLineCap\n                    : defaultLineCap,\n                lineDash: this.pixelRatio_ === 1\n                    ? lineDash\n                    : lineDash.map(function (n) { return n * _this.pixelRatio_; }),\n                lineDashOffset: (strokeStyleLineDashOffset\n                    ? strokeStyleLineDashOffset\n                    : defaultLineDashOffset) * this.pixelRatio_,\n                lineJoin: strokeStyleLineJoin !== undefined\n                    ? strokeStyleLineJoin\n                    : defaultLineJoin,\n                lineWidth: (strokeStyleWidth !== undefined\n                    ? strokeStyleWidth\n                    : defaultLineWidth) * this.pixelRatio_,\n                miterLimit: strokeStyleMiterLimit !== undefined\n                    ? strokeStyleMiterLimit\n                    : defaultMiterLimit,\n                strokeStyle: asColorLike(strokeStyleColor ? strokeStyleColor : defaultStrokeStyle),\n            };\n        }\n    };\n    /**\n     * Set the image style for subsequent draw operations.  Pass null to remove\n     * the image style.\n     *\n     * @param {import(\"../../style/Image.js\").default} imageStyle Image style.\n     */\n    CanvasImmediateRenderer.prototype.setImageStyle = function (imageStyle) {\n        var imageSize;\n        if (!imageStyle || !(imageSize = imageStyle.getSize())) {\n            this.image_ = null;\n            return;\n        }\n        var imageAnchor = imageStyle.getAnchor();\n        var imageOrigin = imageStyle.getOrigin();\n        this.image_ = imageStyle.getImage(this.pixelRatio_);\n        this.imageAnchorX_ = imageAnchor[0] * this.pixelRatio_;\n        this.imageAnchorY_ = imageAnchor[1] * this.pixelRatio_;\n        this.imageHeight_ = imageSize[1] * this.pixelRatio_;\n        this.imageOpacity_ = imageStyle.getOpacity();\n        this.imageOriginX_ = imageOrigin[0];\n        this.imageOriginY_ = imageOrigin[1];\n        this.imageRotateWithView_ = imageStyle.getRotateWithView();\n        this.imageRotation_ = imageStyle.getRotation();\n        this.imageScale_ = imageStyle.getScaleArray();\n        this.imageWidth_ = imageSize[0] * this.pixelRatio_;\n    };\n    /**\n     * Set the text style for subsequent draw operations.  Pass null to\n     * remove the text style.\n     *\n     * @param {import(\"../../style/Text.js\").default} textStyle Text style.\n     */\n    CanvasImmediateRenderer.prototype.setTextStyle = function (textStyle) {\n        if (!textStyle) {\n            this.text_ = '';\n        }\n        else {\n            var textFillStyle = textStyle.getFill();\n            if (!textFillStyle) {\n                this.textFillState_ = null;\n            }\n            else {\n                var textFillStyleColor = textFillStyle.getColor();\n                this.textFillState_ = {\n                    fillStyle: asColorLike(textFillStyleColor ? textFillStyleColor : defaultFillStyle),\n                };\n            }\n            var textStrokeStyle = textStyle.getStroke();\n            if (!textStrokeStyle) {\n                this.textStrokeState_ = null;\n            }\n            else {\n                var textStrokeStyleColor = textStrokeStyle.getColor();\n                var textStrokeStyleLineCap = textStrokeStyle.getLineCap();\n                var textStrokeStyleLineDash = textStrokeStyle.getLineDash();\n                var textStrokeStyleLineDashOffset = textStrokeStyle.getLineDashOffset();\n                var textStrokeStyleLineJoin = textStrokeStyle.getLineJoin();\n                var textStrokeStyleWidth = textStrokeStyle.getWidth();\n                var textStrokeStyleMiterLimit = textStrokeStyle.getMiterLimit();\n                this.textStrokeState_ = {\n                    lineCap: textStrokeStyleLineCap !== undefined\n                        ? textStrokeStyleLineCap\n                        : defaultLineCap,\n                    lineDash: textStrokeStyleLineDash\n                        ? textStrokeStyleLineDash\n                        : defaultLineDash,\n                    lineDashOffset: textStrokeStyleLineDashOffset\n                        ? textStrokeStyleLineDashOffset\n                        : defaultLineDashOffset,\n                    lineJoin: textStrokeStyleLineJoin !== undefined\n                        ? textStrokeStyleLineJoin\n                        : defaultLineJoin,\n                    lineWidth: textStrokeStyleWidth !== undefined\n                        ? textStrokeStyleWidth\n                        : defaultLineWidth,\n                    miterLimit: textStrokeStyleMiterLimit !== undefined\n                        ? textStrokeStyleMiterLimit\n                        : defaultMiterLimit,\n                    strokeStyle: asColorLike(textStrokeStyleColor ? textStrokeStyleColor : defaultStrokeStyle),\n                };\n            }\n            var textFont = textStyle.getFont();\n            var textOffsetX = textStyle.getOffsetX();\n            var textOffsetY = textStyle.getOffsetY();\n            var textRotateWithView = textStyle.getRotateWithView();\n            var textRotation = textStyle.getRotation();\n            var textScale = textStyle.getScaleArray();\n            var textText = textStyle.getText();\n            var textTextAlign = textStyle.getTextAlign();\n            var textTextBaseline = textStyle.getTextBaseline();\n            this.textState_ = {\n                font: textFont !== undefined ? textFont : defaultFont,\n                textAlign: textTextAlign !== undefined ? textTextAlign : defaultTextAlign,\n                textBaseline: textTextBaseline !== undefined\n                    ? textTextBaseline\n                    : defaultTextBaseline,\n            };\n            this.text_ = textText !== undefined ? textText : '';\n            this.textOffsetX_ =\n                textOffsetX !== undefined ? this.pixelRatio_ * textOffsetX : 0;\n            this.textOffsetY_ =\n                textOffsetY !== undefined ? this.pixelRatio_ * textOffsetY : 0;\n            this.textRotateWithView_ =\n                textRotateWithView !== undefined ? textRotateWithView : false;\n            this.textRotation_ = textRotation !== undefined ? textRotation : 0;\n            this.textScale_ = [\n                this.pixelRatio_ * textScale[0],\n                this.pixelRatio_ * textScale[1],\n            ];\n        }\n    };\n    return CanvasImmediateRenderer;\n}(VectorContext));\nexport default CanvasImmediateRenderer;\n"]},"metadata":{},"sourceType":"module"}