{"ast":null,"code":"/**\n * @module ol/format/IIIFInfo\n */\nvar __spreadArray = this && this.__spreadArray || function (to, from) {\n  for (var i = 0, il = from.length, j = to.length; i < il; i++, j++) to[j] = from[i];\n\n  return to;\n};\n\nimport { assert } from '../asserts.js';\nimport { includes } from '../array.js';\n/**\n * @typedef {Object} PreferredOptions\n * @property {string} [format] Preferred image format. Will be used if the image information\n * indicates support for that format.\n * @property {string} [quality] IIIF image qualitiy.  Will be used if the image information\n * indicates support for that quality.\n */\n\n/**\n * @typedef {Object} SupportedFeatures\n * @property {Array<string>} [supports] Supported IIIF image size and region\n * calculation features.\n * @property {Array<string>} [formats] Supported image formats.\n * @property {Array<string>} [qualities] Supported IIIF image qualities.\n */\n\n/**\n * @typedef {Object} TileInfo\n * @property {Array<number>} scaleFactors Supported resolution scaling factors.\n * @property {number} width Tile width in pixels.\n * @property {number} [height] Tile height in pixels. Same as tile width if height is\n * not given.\n */\n\n/**\n * @typedef {Object} IiifProfile\n * @property {Array<string>} [formats] Supported image formats for the image service.\n * @property {Array<string>} [qualities] Supported IIIF image qualities.\n * @property {Array<string>} [supports] Supported features.\n * @property {number} [maxArea] Maximum area (pixels) available for this image service.\n * @property {number} [maxHeight] Maximum height.\n * @property {number} [maxWidth] Maximum width.\n */\n\n/**\n * @typedef {Object<string,string|number|Array<number|string|IiifProfile|Object<string, number>|TileInfo>>}\n *    ImageInformationResponse\n */\n\n/**\n * Enum representing the major IIIF Image API versions\n * @enum {string}\n */\n\nexport var Versions = {\n  VERSION1: 'version1',\n  VERSION2: 'version2',\n  VERSION3: 'version3'\n};\n/**\n * Supported image formats, qualities and supported region / size calculation features\n * for different image API versions and compliance levels\n * @const\n * @type {Object<string, Object<string, SupportedFeatures>>}\n */\n\nvar IIIF_PROFILE_VALUES = {};\nIIIF_PROFILE_VALUES[Versions.VERSION1] = {\n  'level0': {\n    supports: [],\n    formats: [],\n    qualities: ['native']\n  },\n  'level1': {\n    supports: ['regionByPx', 'sizeByW', 'sizeByH', 'sizeByPct'],\n    formats: ['jpg'],\n    qualities: ['native']\n  },\n  'level2': {\n    supports: ['regionByPx', 'regionByPct', 'sizeByW', 'sizeByH', 'sizeByPct', 'sizeByConfinedWh', 'sizeByWh'],\n    formats: ['jpg', 'png'],\n    qualities: ['native', 'color', 'grey', 'bitonal']\n  }\n};\nIIIF_PROFILE_VALUES[Versions.VERSION2] = {\n  'level0': {\n    supports: [],\n    formats: ['jpg'],\n    qualities: ['default']\n  },\n  'level1': {\n    supports: ['regionByPx', 'sizeByW', 'sizeByH', 'sizeByPct'],\n    formats: ['jpg'],\n    qualities: ['default']\n  },\n  'level2': {\n    supports: ['regionByPx', 'regionByPct', 'sizeByW', 'sizeByH', 'sizeByPct', 'sizeByConfinedWh', 'sizeByDistortedWh', 'sizeByWh'],\n    formats: ['jpg', 'png'],\n    qualities: ['default', 'bitonal']\n  }\n};\nIIIF_PROFILE_VALUES[Versions.VERSION3] = {\n  'level0': {\n    supports: [],\n    formats: ['jpg'],\n    qualities: ['default']\n  },\n  'level1': {\n    supports: ['regionByPx', 'regionSquare', 'sizeByW', 'sizeByH', 'sizeByWh'],\n    formats: ['jpg'],\n    qualities: ['default']\n  },\n  'level2': {\n    supports: ['regionByPx', 'regionSquare', 'regionByPct', 'sizeByW', 'sizeByH', 'sizeByPct', 'sizeByConfinedWh', 'sizeByWh'],\n    formats: ['jpg', 'png'],\n    qualities: ['default']\n  }\n};\nIIIF_PROFILE_VALUES['none'] = {\n  'none': {\n    supports: [],\n    formats: [],\n    qualities: []\n  }\n};\nvar COMPLIANCE_VERSION1 = /^https?:\\/\\/library\\.stanford\\.edu\\/iiif\\/image-api\\/(?:1\\.1\\/)?compliance\\.html#level[0-2]$/;\nvar COMPLIANCE_VERSION2 = /^https?:\\/\\/iiif\\.io\\/api\\/image\\/2\\/level[0-2](?:\\.json)?$/;\nvar COMPLIANCE_VERSION3 = /(^https?:\\/\\/iiif\\.io\\/api\\/image\\/3\\/level[0-2](?:\\.json)?$)|(^level[0-2]$)/;\n\nfunction generateVersion1Options(iiifInfo) {\n  var levelProfile = iiifInfo.getComplianceLevelSupportedFeatures(); // Version 1.0 and 1.1 do not require a profile.\n\n  if (levelProfile === undefined) {\n    levelProfile = IIIF_PROFILE_VALUES[Versions.VERSION1]['level0'];\n  }\n\n  return {\n    url: iiifInfo.imageInfo['@id'] === undefined ? undefined : iiifInfo.imageInfo['@id'].replace(/\\/?(?:info\\.json)?$/g, ''),\n    supports: levelProfile.supports,\n    formats: __spreadArray(__spreadArray([], levelProfile.formats), [iiifInfo.imageInfo.formats === undefined ? [] : iiifInfo.imageInfo.formats]),\n    qualities: __spreadArray(__spreadArray([], levelProfile.qualities), [iiifInfo.imageInfo.qualities === undefined ? [] : iiifInfo.imageInfo.qualities]),\n    resolutions: iiifInfo.imageInfo.scale_factors,\n    tileSize: iiifInfo.imageInfo.tile_width !== undefined ? iiifInfo.imageInfo.tile_height !== undefined ? [iiifInfo.imageInfo.tile_width, iiifInfo.imageInfo.tile_height] : [iiifInfo.imageInfo.tile_width, iiifInfo.imageInfo.tile_width] : iiifInfo.imageInfo.tile_height != undefined ? [iiifInfo.imageInfo.tile_height, iiifInfo.imageInfo.tile_height] : undefined\n  };\n}\n\nfunction generateVersion2Options(iiifInfo) {\n  var levelProfile = iiifInfo.getComplianceLevelSupportedFeatures(),\n      additionalProfile = Array.isArray(iiifInfo.imageInfo.profile) && iiifInfo.imageInfo.profile.length > 1,\n      profileSupports = additionalProfile && iiifInfo.imageInfo.profile[1].supports ? iiifInfo.imageInfo.profile[1].supports : [],\n      profileFormats = additionalProfile && iiifInfo.imageInfo.profile[1].formats ? iiifInfo.imageInfo.profile[1].formats : [],\n      profileQualities = additionalProfile && iiifInfo.imageInfo.profile[1].qualities ? iiifInfo.imageInfo.profile[1].qualities : [];\n  return {\n    url: iiifInfo.imageInfo['@id'].replace(/\\/?(?:info\\.json)?$/g, ''),\n    sizes: iiifInfo.imageInfo.sizes === undefined ? undefined : iiifInfo.imageInfo.sizes.map(function (size) {\n      return [size.width, size.height];\n    }),\n    tileSize: iiifInfo.imageInfo.tiles === undefined ? undefined : [iiifInfo.imageInfo.tiles.map(function (tile) {\n      return tile.width;\n    })[0], iiifInfo.imageInfo.tiles.map(function (tile) {\n      return tile.height === undefined ? tile.width : tile.height;\n    })[0]],\n    resolutions: iiifInfo.imageInfo.tiles === undefined ? undefined : iiifInfo.imageInfo.tiles.map(function (tile) {\n      return tile.scaleFactors;\n    })[0],\n    supports: __spreadArray(__spreadArray([], levelProfile.supports), profileSupports),\n    formats: __spreadArray(__spreadArray([], levelProfile.formats), profileFormats),\n    qualities: __spreadArray(__spreadArray([], levelProfile.qualities), profileQualities)\n  };\n}\n\nfunction generateVersion3Options(iiifInfo) {\n  var levelProfile = iiifInfo.getComplianceLevelSupportedFeatures(),\n      formats = iiifInfo.imageInfo.extraFormats === undefined ? levelProfile.formats : __spreadArray(__spreadArray([], levelProfile.formats), iiifInfo.imageInfo.extraFormats),\n      preferredFormat = iiifInfo.imageInfo.preferredFormats !== undefined && Array.isArray(iiifInfo.imageInfo.preferredFormats) && iiifInfo.imageInfo.preferredFormats.length > 0 ? iiifInfo.imageInfo.preferredFormats.filter(function (format) {\n    return includes(['jpg', 'png', 'gif'], format);\n  }).reduce(function (acc, format) {\n    return acc === undefined && includes(formats, format) ? format : acc;\n  }, undefined) : undefined;\n  return {\n    url: iiifInfo.imageInfo['id'],\n    sizes: iiifInfo.imageInfo.sizes === undefined ? undefined : iiifInfo.imageInfo.sizes.map(function (size) {\n      return [size.width, size.height];\n    }),\n    tileSize: iiifInfo.imageInfo.tiles === undefined ? undefined : [iiifInfo.imageInfo.tiles.map(function (tile) {\n      return tile.width;\n    })[0], iiifInfo.imageInfo.tiles.map(function (tile) {\n      return tile.height;\n    })[0]],\n    resolutions: iiifInfo.imageInfo.tiles === undefined ? undefined : iiifInfo.imageInfo.tiles.map(function (tile) {\n      return tile.scaleFactors;\n    })[0],\n    supports: iiifInfo.imageInfo.extraFeatures === undefined ? levelProfile.supports : __spreadArray(__spreadArray([], levelProfile.supports), iiifInfo.imageInfo.extraFeatures),\n    formats: formats,\n    qualities: iiifInfo.imageInfo.extraQualities === undefined ? levelProfile.qualities : __spreadArray(__spreadArray([], levelProfile.qualities), iiifInfo.imageInfo.extraQualities),\n    preferredFormat: preferredFormat\n  };\n}\n\nvar versionFunctions = {};\nversionFunctions[Versions.VERSION1] = generateVersion1Options;\nversionFunctions[Versions.VERSION2] = generateVersion2Options;\nversionFunctions[Versions.VERSION3] = generateVersion3Options;\n/**\n * @classdesc\n * Format for transforming IIIF Image API image information responses into\n * IIIF tile source ready options\n *\n * @api\n */\n\nvar IIIFInfo = function () {\n  /**\n   * @param {string|ImageInformationResponse} imageInfo\n   * Deserialized image information JSON response object or JSON response as string\n   */\n  function IIIFInfo(imageInfo) {\n    this.setImageInfo(imageInfo);\n  }\n  /**\n   * @param {string|ImageInformationResponse} imageInfo\n   * Deserialized image information JSON response object or JSON response as string\n   * @api\n   */\n\n\n  IIIFInfo.prototype.setImageInfo = function (imageInfo) {\n    if (typeof imageInfo == 'string') {\n      this.imageInfo = JSON.parse(imageInfo);\n    } else {\n      this.imageInfo = imageInfo;\n    }\n  };\n  /**\n   * @return {Versions} Major IIIF version.\n   * @api\n   */\n\n\n  IIIFInfo.prototype.getImageApiVersion = function () {\n    if (this.imageInfo === undefined) {\n      return;\n    }\n\n    var context = this.imageInfo['@context'] || 'ol-no-context';\n\n    if (typeof context == 'string') {\n      context = [context];\n    }\n\n    for (var i = 0; i < context.length; i++) {\n      switch (context[i]) {\n        case 'http://library.stanford.edu/iiif/image-api/1.1/context.json':\n        case 'http://iiif.io/api/image/1/context.json':\n          return Versions.VERSION1;\n\n        case 'http://iiif.io/api/image/2/context.json':\n          return Versions.VERSION2;\n\n        case 'http://iiif.io/api/image/3/context.json':\n          return Versions.VERSION3;\n\n        case 'ol-no-context':\n          // Image API 1.0 has no '@context'\n          if (this.getComplianceLevelEntryFromProfile(Versions.VERSION1) && this.imageInfo.identifier) {\n            return Versions.VERSION1;\n          }\n\n          break;\n\n        default:\n      }\n    }\n\n    assert(false, 61);\n  };\n  /**\n   * @param {Versions} version Optional IIIF image API version\n   * @return {string} Compliance level as it appears in the IIIF image information\n   * response.\n   */\n\n\n  IIIFInfo.prototype.getComplianceLevelEntryFromProfile = function (version) {\n    if (this.imageInfo === undefined || this.imageInfo.profile === undefined) {\n      return;\n    }\n\n    if (version === undefined) {\n      version = this.getImageApiVersion();\n    }\n\n    switch (version) {\n      case Versions.VERSION1:\n        if (COMPLIANCE_VERSION1.test(this.imageInfo.profile)) {\n          return this.imageInfo.profile;\n        }\n\n        break;\n\n      case Versions.VERSION3:\n        if (COMPLIANCE_VERSION3.test(this.imageInfo.profile)) {\n          return this.imageInfo.profile;\n        }\n\n        break;\n\n      case Versions.VERSION2:\n        if (typeof this.imageInfo.profile === 'string' && COMPLIANCE_VERSION2.test(this.imageInfo.profile)) {\n          return this.imageInfo.profile;\n        }\n\n        if (Array.isArray(this.imageInfo.profile) && this.imageInfo.profile.length > 0 && typeof this.imageInfo.profile[0] === 'string' && COMPLIANCE_VERSION2.test(this.imageInfo.profile[0])) {\n          return this.imageInfo.profile[0];\n        }\n\n        break;\n\n      default:\n    }\n  };\n  /**\n   * @param {Versions} version Optional IIIF image API version\n   * @return {string} Compliance level, on of 'level0', 'level1' or 'level2' or undefined\n   */\n\n\n  IIIFInfo.prototype.getComplianceLevelFromProfile = function (version) {\n    var complianceLevel = this.getComplianceLevelEntryFromProfile(version);\n\n    if (complianceLevel === undefined) {\n      return undefined;\n    }\n\n    var level = complianceLevel.match(/level[0-2](?:\\.json)?$/g);\n    return Array.isArray(level) ? level[0].replace('.json', '') : undefined;\n  };\n  /**\n   * @return {SupportedFeatures} Image formats, qualities and region / size calculation\n   * methods that are supported by the IIIF service.\n   */\n\n\n  IIIFInfo.prototype.getComplianceLevelSupportedFeatures = function () {\n    if (this.imageInfo === undefined) {\n      return;\n    }\n\n    var version = this.getImageApiVersion();\n    var level = this.getComplianceLevelFromProfile(version);\n\n    if (level === undefined) {\n      return IIIF_PROFILE_VALUES['none']['none'];\n    }\n\n    return IIIF_PROFILE_VALUES[version][level];\n  };\n  /**\n   * @param {PreferredOptions} [opt_preferredOptions] Optional options for preferred format and quality.\n   * @return {import(\"../source/IIIF.js\").Options} IIIF tile source ready constructor options.\n   * @api\n   */\n\n\n  IIIFInfo.prototype.getTileSourceOptions = function (opt_preferredOptions) {\n    var options = opt_preferredOptions || {},\n        version = this.getImageApiVersion();\n\n    if (version === undefined) {\n      return;\n    }\n\n    var imageOptions = version === undefined ? undefined : versionFunctions[version](this);\n\n    if (imageOptions === undefined) {\n      return;\n    }\n\n    return {\n      url: imageOptions.url,\n      version: version,\n      size: [this.imageInfo.width, this.imageInfo.height],\n      sizes: imageOptions.sizes,\n      format: options.format !== undefined && includes(imageOptions.formats, options.format) ? options.format : imageOptions.preferredFormat !== undefined ? imageOptions.preferredFormat : 'jpg',\n      supports: imageOptions.supports,\n      quality: options.quality && includes(imageOptions.qualities, options.quality) ? options.quality : includes(imageOptions.qualities, 'native') ? 'native' : 'default',\n      resolutions: Array.isArray(imageOptions.resolutions) ? imageOptions.resolutions.sort(function (a, b) {\n        return b - a;\n      }) : undefined,\n      tileSize: imageOptions.tileSize\n    };\n  };\n\n  return IIIFInfo;\n}();\n\nexport default IIIFInfo;","map":{"version":3,"sources":["C:/Users/admin/Downloads/igo2-lib-master/igo2-lib-master/node_modules/ol/format/IIIFInfo.js"],"names":["__spreadArray","to","from","i","il","length","j","assert","includes","Versions","VERSION1","VERSION2","VERSION3","IIIF_PROFILE_VALUES","supports","formats","qualities","COMPLIANCE_VERSION1","COMPLIANCE_VERSION2","COMPLIANCE_VERSION3","generateVersion1Options","iiifInfo","levelProfile","getComplianceLevelSupportedFeatures","undefined","url","imageInfo","replace","resolutions","scale_factors","tileSize","tile_width","tile_height","generateVersion2Options","additionalProfile","Array","isArray","profile","profileSupports","profileFormats","profileQualities","sizes","map","size","width","height","tiles","tile","scaleFactors","generateVersion3Options","extraFormats","preferredFormat","preferredFormats","filter","format","reduce","acc","extraFeatures","extraQualities","versionFunctions","IIIFInfo","setImageInfo","prototype","JSON","parse","getImageApiVersion","context","getComplianceLevelEntryFromProfile","identifier","version","test","getComplianceLevelFromProfile","complianceLevel","level","match","getTileSourceOptions","opt_preferredOptions","options","imageOptions","quality","sort","a","b"],"mappings":"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","sourcesContent":["/**\n * @module ol/format/IIIFInfo\n */\nvar __spreadArray = (this && this.__spreadArray) || function (to, from) {\n    for (var i = 0, il = from.length, j = to.length; i < il; i++, j++)\n        to[j] = from[i];\n    return to;\n};\nimport { assert } from '../asserts.js';\nimport { includes } from '../array.js';\n/**\n * @typedef {Object} PreferredOptions\n * @property {string} [format] Preferred image format. Will be used if the image information\n * indicates support for that format.\n * @property {string} [quality] IIIF image qualitiy.  Will be used if the image information\n * indicates support for that quality.\n */\n/**\n * @typedef {Object} SupportedFeatures\n * @property {Array<string>} [supports] Supported IIIF image size and region\n * calculation features.\n * @property {Array<string>} [formats] Supported image formats.\n * @property {Array<string>} [qualities] Supported IIIF image qualities.\n */\n/**\n * @typedef {Object} TileInfo\n * @property {Array<number>} scaleFactors Supported resolution scaling factors.\n * @property {number} width Tile width in pixels.\n * @property {number} [height] Tile height in pixels. Same as tile width if height is\n * not given.\n */\n/**\n * @typedef {Object} IiifProfile\n * @property {Array<string>} [formats] Supported image formats for the image service.\n * @property {Array<string>} [qualities] Supported IIIF image qualities.\n * @property {Array<string>} [supports] Supported features.\n * @property {number} [maxArea] Maximum area (pixels) available for this image service.\n * @property {number} [maxHeight] Maximum height.\n * @property {number} [maxWidth] Maximum width.\n */\n/**\n * @typedef {Object<string,string|number|Array<number|string|IiifProfile|Object<string, number>|TileInfo>>}\n *    ImageInformationResponse\n */\n/**\n * Enum representing the major IIIF Image API versions\n * @enum {string}\n */\nexport var Versions = {\n    VERSION1: 'version1',\n    VERSION2: 'version2',\n    VERSION3: 'version3',\n};\n/**\n * Supported image formats, qualities and supported region / size calculation features\n * for different image API versions and compliance levels\n * @const\n * @type {Object<string, Object<string, SupportedFeatures>>}\n */\nvar IIIF_PROFILE_VALUES = {};\nIIIF_PROFILE_VALUES[Versions.VERSION1] = {\n    'level0': {\n        supports: [],\n        formats: [],\n        qualities: ['native'],\n    },\n    'level1': {\n        supports: ['regionByPx', 'sizeByW', 'sizeByH', 'sizeByPct'],\n        formats: ['jpg'],\n        qualities: ['native'],\n    },\n    'level2': {\n        supports: [\n            'regionByPx',\n            'regionByPct',\n            'sizeByW',\n            'sizeByH',\n            'sizeByPct',\n            'sizeByConfinedWh',\n            'sizeByWh',\n        ],\n        formats: ['jpg', 'png'],\n        qualities: ['native', 'color', 'grey', 'bitonal'],\n    },\n};\nIIIF_PROFILE_VALUES[Versions.VERSION2] = {\n    'level0': {\n        supports: [],\n        formats: ['jpg'],\n        qualities: ['default'],\n    },\n    'level1': {\n        supports: ['regionByPx', 'sizeByW', 'sizeByH', 'sizeByPct'],\n        formats: ['jpg'],\n        qualities: ['default'],\n    },\n    'level2': {\n        supports: [\n            'regionByPx',\n            'regionByPct',\n            'sizeByW',\n            'sizeByH',\n            'sizeByPct',\n            'sizeByConfinedWh',\n            'sizeByDistortedWh',\n            'sizeByWh',\n        ],\n        formats: ['jpg', 'png'],\n        qualities: ['default', 'bitonal'],\n    },\n};\nIIIF_PROFILE_VALUES[Versions.VERSION3] = {\n    'level0': {\n        supports: [],\n        formats: ['jpg'],\n        qualities: ['default'],\n    },\n    'level1': {\n        supports: ['regionByPx', 'regionSquare', 'sizeByW', 'sizeByH', 'sizeByWh'],\n        formats: ['jpg'],\n        qualities: ['default'],\n    },\n    'level2': {\n        supports: [\n            'regionByPx',\n            'regionSquare',\n            'regionByPct',\n            'sizeByW',\n            'sizeByH',\n            'sizeByPct',\n            'sizeByConfinedWh',\n            'sizeByWh',\n        ],\n        formats: ['jpg', 'png'],\n        qualities: ['default'],\n    },\n};\nIIIF_PROFILE_VALUES['none'] = {\n    'none': {\n        supports: [],\n        formats: [],\n        qualities: [],\n    },\n};\nvar COMPLIANCE_VERSION1 = /^https?:\\/\\/library\\.stanford\\.edu\\/iiif\\/image-api\\/(?:1\\.1\\/)?compliance\\.html#level[0-2]$/;\nvar COMPLIANCE_VERSION2 = /^https?:\\/\\/iiif\\.io\\/api\\/image\\/2\\/level[0-2](?:\\.json)?$/;\nvar COMPLIANCE_VERSION3 = /(^https?:\\/\\/iiif\\.io\\/api\\/image\\/3\\/level[0-2](?:\\.json)?$)|(^level[0-2]$)/;\nfunction generateVersion1Options(iiifInfo) {\n    var levelProfile = iiifInfo.getComplianceLevelSupportedFeatures();\n    // Version 1.0 and 1.1 do not require a profile.\n    if (levelProfile === undefined) {\n        levelProfile = IIIF_PROFILE_VALUES[Versions.VERSION1]['level0'];\n    }\n    return {\n        url: iiifInfo.imageInfo['@id'] === undefined\n            ? undefined\n            : iiifInfo.imageInfo['@id'].replace(/\\/?(?:info\\.json)?$/g, ''),\n        supports: levelProfile.supports,\n        formats: __spreadArray(__spreadArray([], levelProfile.formats), [\n            iiifInfo.imageInfo.formats === undefined\n                ? []\n                : iiifInfo.imageInfo.formats,\n        ]),\n        qualities: __spreadArray(__spreadArray([], levelProfile.qualities), [\n            iiifInfo.imageInfo.qualities === undefined\n                ? []\n                : iiifInfo.imageInfo.qualities,\n        ]),\n        resolutions: iiifInfo.imageInfo.scale_factors,\n        tileSize: iiifInfo.imageInfo.tile_width !== undefined\n            ? iiifInfo.imageInfo.tile_height !== undefined\n                ? [iiifInfo.imageInfo.tile_width, iiifInfo.imageInfo.tile_height]\n                : [iiifInfo.imageInfo.tile_width, iiifInfo.imageInfo.tile_width]\n            : iiifInfo.imageInfo.tile_height != undefined\n                ? [iiifInfo.imageInfo.tile_height, iiifInfo.imageInfo.tile_height]\n                : undefined,\n    };\n}\nfunction generateVersion2Options(iiifInfo) {\n    var levelProfile = iiifInfo.getComplianceLevelSupportedFeatures(), additionalProfile = Array.isArray(iiifInfo.imageInfo.profile) &&\n        iiifInfo.imageInfo.profile.length > 1, profileSupports = additionalProfile && iiifInfo.imageInfo.profile[1].supports\n        ? iiifInfo.imageInfo.profile[1].supports\n        : [], profileFormats = additionalProfile && iiifInfo.imageInfo.profile[1].formats\n        ? iiifInfo.imageInfo.profile[1].formats\n        : [], profileQualities = additionalProfile && iiifInfo.imageInfo.profile[1].qualities\n        ? iiifInfo.imageInfo.profile[1].qualities\n        : [];\n    return {\n        url: iiifInfo.imageInfo['@id'].replace(/\\/?(?:info\\.json)?$/g, ''),\n        sizes: iiifInfo.imageInfo.sizes === undefined\n            ? undefined\n            : iiifInfo.imageInfo.sizes.map(function (size) {\n                return [size.width, size.height];\n            }),\n        tileSize: iiifInfo.imageInfo.tiles === undefined\n            ? undefined\n            : [\n                iiifInfo.imageInfo.tiles.map(function (tile) {\n                    return tile.width;\n                })[0],\n                iiifInfo.imageInfo.tiles.map(function (tile) {\n                    return tile.height === undefined ? tile.width : tile.height;\n                })[0],\n            ],\n        resolutions: iiifInfo.imageInfo.tiles === undefined\n            ? undefined\n            : iiifInfo.imageInfo.tiles.map(function (tile) {\n                return tile.scaleFactors;\n            })[0],\n        supports: __spreadArray(__spreadArray([], levelProfile.supports), profileSupports),\n        formats: __spreadArray(__spreadArray([], levelProfile.formats), profileFormats),\n        qualities: __spreadArray(__spreadArray([], levelProfile.qualities), profileQualities),\n    };\n}\nfunction generateVersion3Options(iiifInfo) {\n    var levelProfile = iiifInfo.getComplianceLevelSupportedFeatures(), formats = iiifInfo.imageInfo.extraFormats === undefined\n        ? levelProfile.formats\n        : __spreadArray(__spreadArray([], levelProfile.formats), iiifInfo.imageInfo.extraFormats), preferredFormat = iiifInfo.imageInfo.preferredFormats !== undefined &&\n        Array.isArray(iiifInfo.imageInfo.preferredFormats) &&\n        iiifInfo.imageInfo.preferredFormats.length > 0\n        ? iiifInfo.imageInfo.preferredFormats\n            .filter(function (format) {\n            return includes(['jpg', 'png', 'gif'], format);\n        })\n            .reduce(function (acc, format) {\n            return acc === undefined && includes(formats, format)\n                ? format\n                : acc;\n        }, undefined)\n        : undefined;\n    return {\n        url: iiifInfo.imageInfo['id'],\n        sizes: iiifInfo.imageInfo.sizes === undefined\n            ? undefined\n            : iiifInfo.imageInfo.sizes.map(function (size) {\n                return [size.width, size.height];\n            }),\n        tileSize: iiifInfo.imageInfo.tiles === undefined\n            ? undefined\n            : [\n                iiifInfo.imageInfo.tiles.map(function (tile) {\n                    return tile.width;\n                })[0],\n                iiifInfo.imageInfo.tiles.map(function (tile) {\n                    return tile.height;\n                })[0],\n            ],\n        resolutions: iiifInfo.imageInfo.tiles === undefined\n            ? undefined\n            : iiifInfo.imageInfo.tiles.map(function (tile) {\n                return tile.scaleFactors;\n            })[0],\n        supports: iiifInfo.imageInfo.extraFeatures === undefined\n            ? levelProfile.supports\n            : __spreadArray(__spreadArray([], levelProfile.supports), iiifInfo.imageInfo.extraFeatures),\n        formats: formats,\n        qualities: iiifInfo.imageInfo.extraQualities === undefined\n            ? levelProfile.qualities\n            : __spreadArray(__spreadArray([], levelProfile.qualities), iiifInfo.imageInfo.extraQualities),\n        preferredFormat: preferredFormat,\n    };\n}\nvar versionFunctions = {};\nversionFunctions[Versions.VERSION1] = generateVersion1Options;\nversionFunctions[Versions.VERSION2] = generateVersion2Options;\nversionFunctions[Versions.VERSION3] = generateVersion3Options;\n/**\n * @classdesc\n * Format for transforming IIIF Image API image information responses into\n * IIIF tile source ready options\n *\n * @api\n */\nvar IIIFInfo = /** @class */ (function () {\n    /**\n     * @param {string|ImageInformationResponse} imageInfo\n     * Deserialized image information JSON response object or JSON response as string\n     */\n    function IIIFInfo(imageInfo) {\n        this.setImageInfo(imageInfo);\n    }\n    /**\n     * @param {string|ImageInformationResponse} imageInfo\n     * Deserialized image information JSON response object or JSON response as string\n     * @api\n     */\n    IIIFInfo.prototype.setImageInfo = function (imageInfo) {\n        if (typeof imageInfo == 'string') {\n            this.imageInfo = JSON.parse(imageInfo);\n        }\n        else {\n            this.imageInfo = imageInfo;\n        }\n    };\n    /**\n     * @return {Versions} Major IIIF version.\n     * @api\n     */\n    IIIFInfo.prototype.getImageApiVersion = function () {\n        if (this.imageInfo === undefined) {\n            return;\n        }\n        var context = this.imageInfo['@context'] || 'ol-no-context';\n        if (typeof context == 'string') {\n            context = [context];\n        }\n        for (var i = 0; i < context.length; i++) {\n            switch (context[i]) {\n                case 'http://library.stanford.edu/iiif/image-api/1.1/context.json':\n                case 'http://iiif.io/api/image/1/context.json':\n                    return Versions.VERSION1;\n                case 'http://iiif.io/api/image/2/context.json':\n                    return Versions.VERSION2;\n                case 'http://iiif.io/api/image/3/context.json':\n                    return Versions.VERSION3;\n                case 'ol-no-context':\n                    // Image API 1.0 has no '@context'\n                    if (this.getComplianceLevelEntryFromProfile(Versions.VERSION1) &&\n                        this.imageInfo.identifier) {\n                        return Versions.VERSION1;\n                    }\n                    break;\n                default:\n            }\n        }\n        assert(false, 61);\n    };\n    /**\n     * @param {Versions} version Optional IIIF image API version\n     * @return {string} Compliance level as it appears in the IIIF image information\n     * response.\n     */\n    IIIFInfo.prototype.getComplianceLevelEntryFromProfile = function (version) {\n        if (this.imageInfo === undefined || this.imageInfo.profile === undefined) {\n            return;\n        }\n        if (version === undefined) {\n            version = this.getImageApiVersion();\n        }\n        switch (version) {\n            case Versions.VERSION1:\n                if (COMPLIANCE_VERSION1.test(this.imageInfo.profile)) {\n                    return this.imageInfo.profile;\n                }\n                break;\n            case Versions.VERSION3:\n                if (COMPLIANCE_VERSION3.test(this.imageInfo.profile)) {\n                    return this.imageInfo.profile;\n                }\n                break;\n            case Versions.VERSION2:\n                if (typeof this.imageInfo.profile === 'string' &&\n                    COMPLIANCE_VERSION2.test(this.imageInfo.profile)) {\n                    return this.imageInfo.profile;\n                }\n                if (Array.isArray(this.imageInfo.profile) &&\n                    this.imageInfo.profile.length > 0 &&\n                    typeof this.imageInfo.profile[0] === 'string' &&\n                    COMPLIANCE_VERSION2.test(this.imageInfo.profile[0])) {\n                    return this.imageInfo.profile[0];\n                }\n                break;\n            default:\n        }\n    };\n    /**\n     * @param {Versions} version Optional IIIF image API version\n     * @return {string} Compliance level, on of 'level0', 'level1' or 'level2' or undefined\n     */\n    IIIFInfo.prototype.getComplianceLevelFromProfile = function (version) {\n        var complianceLevel = this.getComplianceLevelEntryFromProfile(version);\n        if (complianceLevel === undefined) {\n            return undefined;\n        }\n        var level = complianceLevel.match(/level[0-2](?:\\.json)?$/g);\n        return Array.isArray(level) ? level[0].replace('.json', '') : undefined;\n    };\n    /**\n     * @return {SupportedFeatures} Image formats, qualities and region / size calculation\n     * methods that are supported by the IIIF service.\n     */\n    IIIFInfo.prototype.getComplianceLevelSupportedFeatures = function () {\n        if (this.imageInfo === undefined) {\n            return;\n        }\n        var version = this.getImageApiVersion();\n        var level = this.getComplianceLevelFromProfile(version);\n        if (level === undefined) {\n            return IIIF_PROFILE_VALUES['none']['none'];\n        }\n        return IIIF_PROFILE_VALUES[version][level];\n    };\n    /**\n     * @param {PreferredOptions} [opt_preferredOptions] Optional options for preferred format and quality.\n     * @return {import(\"../source/IIIF.js\").Options} IIIF tile source ready constructor options.\n     * @api\n     */\n    IIIFInfo.prototype.getTileSourceOptions = function (opt_preferredOptions) {\n        var options = opt_preferredOptions || {}, version = this.getImageApiVersion();\n        if (version === undefined) {\n            return;\n        }\n        var imageOptions = version === undefined ? undefined : versionFunctions[version](this);\n        if (imageOptions === undefined) {\n            return;\n        }\n        return {\n            url: imageOptions.url,\n            version: version,\n            size: [this.imageInfo.width, this.imageInfo.height],\n            sizes: imageOptions.sizes,\n            format: options.format !== undefined &&\n                includes(imageOptions.formats, options.format)\n                ? options.format\n                : imageOptions.preferredFormat !== undefined\n                    ? imageOptions.preferredFormat\n                    : 'jpg',\n            supports: imageOptions.supports,\n            quality: options.quality && includes(imageOptions.qualities, options.quality)\n                ? options.quality\n                : includes(imageOptions.qualities, 'native')\n                    ? 'native'\n                    : 'default',\n            resolutions: Array.isArray(imageOptions.resolutions)\n                ? imageOptions.resolutions.sort(function (a, b) {\n                    return b - a;\n                })\n                : undefined,\n            tileSize: imageOptions.tileSize,\n        };\n    };\n    return IIIFInfo;\n}());\nexport default IIIFInfo;\n"]},"metadata":{},"sourceType":"module"}