{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n/**\n * @module ol/render/canvas/ImageBuilder\n */\n\n\nimport CanvasBuilder from './Builder.js';\nimport CanvasInstruction from './Instruction.js';\n\nvar CanvasImageBuilder = function (_super) {\n  __extends(CanvasImageBuilder, _super);\n  /**\n   * @param {number} tolerance Tolerance.\n   * @param {import(\"../../extent.js\").Extent} maxExtent Maximum extent.\n   * @param {number} resolution Resolution.\n   * @param {number} pixelRatio Pixel ratio.\n   */\n\n\n  function CanvasImageBuilder(tolerance, maxExtent, resolution, pixelRatio) {\n    var _this = _super.call(this, tolerance, maxExtent, resolution, pixelRatio) || this;\n    /**\n     * @private\n     * @type {HTMLCanvasElement|HTMLVideoElement|HTMLImageElement}\n     */\n\n\n    _this.hitDetectionImage_ = null;\n    /**\n     * @private\n     * @type {HTMLCanvasElement|HTMLVideoElement|HTMLImageElement}\n     */\n\n    _this.image_ = null;\n    /**\n     * @private\n     * @type {number|undefined}\n     */\n\n    _this.imagePixelRatio_ = undefined;\n    /**\n     * @private\n     * @type {number|undefined}\n     */\n\n    _this.anchorX_ = undefined;\n    /**\n     * @private\n     * @type {number|undefined}\n     */\n\n    _this.anchorY_ = undefined;\n    /**\n     * @private\n     * @type {number|undefined}\n     */\n\n    _this.height_ = undefined;\n    /**\n     * @private\n     * @type {number|undefined}\n     */\n\n    _this.opacity_ = undefined;\n    /**\n     * @private\n     * @type {number|undefined}\n     */\n\n    _this.originX_ = undefined;\n    /**\n     * @private\n     * @type {number|undefined}\n     */\n\n    _this.originY_ = undefined;\n    /**\n     * @private\n     * @type {boolean|undefined}\n     */\n\n    _this.rotateWithView_ = undefined;\n    /**\n     * @private\n     * @type {number|undefined}\n     */\n\n    _this.rotation_ = undefined;\n    /**\n     * @private\n     * @type {import(\"../../size.js\").Size|undefined}\n     */\n\n    _this.scale_ = undefined;\n    /**\n     * @private\n     * @type {number|undefined}\n     */\n\n    _this.width_ = undefined;\n    /**\n     * Data shared with a text builder for combined decluttering.\n     * @private\n     * @type {import(\"../canvas.js\").DeclutterImageWithText}\n     */\n\n    _this.declutterImageWithText_ = undefined;\n    return _this;\n  }\n  /**\n   * @param {import(\"../../geom/Point.js\").default|import(\"../Feature.js\").default} pointGeometry Point geometry.\n   * @param {import(\"../../Feature.js\").FeatureLike} feature Feature.\n   */\n\n\n  CanvasImageBuilder.prototype.drawPoint = function (pointGeometry, feature) {\n    if (!this.image_) {\n      return;\n    }\n\n    this.beginGeometry(pointGeometry, feature);\n    var flatCoordinates = pointGeometry.getFlatCoordinates();\n    var stride = pointGeometry.getStride();\n    var myBegin = this.coordinates.length;\n    var myEnd = this.appendFlatPointCoordinates(flatCoordinates, stride);\n    this.instructions.push([CanvasInstruction.DRAW_IMAGE, myBegin, myEnd, this.image_, // Remaining arguments to DRAW_IMAGE are in alphabetical order\n    this.anchorX_ * this.imagePixelRatio_, this.anchorY_ * this.imagePixelRatio_, Math.ceil(this.height_ * this.imagePixelRatio_), this.opacity_, this.originX_, this.originY_, this.rotateWithView_, this.rotation_, [this.scale_[0] * this.pixelRatio / this.imagePixelRatio_, this.scale_[1] * this.pixelRatio / this.imagePixelRatio_], Math.ceil(this.width_ * this.imagePixelRatio_), this.declutterImageWithText_]);\n    this.hitDetectionInstructions.push([CanvasInstruction.DRAW_IMAGE, myBegin, myEnd, this.hitDetectionImage_, // Remaining arguments to DRAW_IMAGE are in alphabetical order\n    this.anchorX_, this.anchorY_, this.height_, this.opacity_, this.originX_, this.originY_, this.rotateWithView_, this.rotation_, this.scale_, this.width_, this.declutterImageWithText_]);\n    this.endGeometry(feature);\n  };\n  /**\n   * @param {import(\"../../geom/MultiPoint.js\").default|import(\"../Feature.js\").default} multiPointGeometry MultiPoint geometry.\n   * @param {import(\"../../Feature.js\").FeatureLike} feature Feature.\n   */\n\n\n  CanvasImageBuilder.prototype.drawMultiPoint = function (multiPointGeometry, feature) {\n    if (!this.image_) {\n      return;\n    }\n\n    this.beginGeometry(multiPointGeometry, feature);\n    var flatCoordinates = multiPointGeometry.getFlatCoordinates();\n    var stride = multiPointGeometry.getStride();\n    var myBegin = this.coordinates.length;\n    var myEnd = this.appendFlatPointCoordinates(flatCoordinates, stride);\n    this.instructions.push([CanvasInstruction.DRAW_IMAGE, myBegin, myEnd, this.image_, // Remaining arguments to DRAW_IMAGE are in alphabetical order\n    this.anchorX_ * this.imagePixelRatio_, this.anchorY_ * this.imagePixelRatio_, Math.ceil(this.height_ * this.imagePixelRatio_), this.opacity_, this.originX_, this.originY_, this.rotateWithView_, this.rotation_, [this.scale_[0] * this.pixelRatio / this.imagePixelRatio_, this.scale_[1] * this.pixelRatio / this.imagePixelRatio_], Math.ceil(this.width_ * this.imagePixelRatio_), this.declutterImageWithText_]);\n    this.hitDetectionInstructions.push([CanvasInstruction.DRAW_IMAGE, myBegin, myEnd, this.hitDetectionImage_, // Remaining arguments to DRAW_IMAGE are in alphabetical order\n    this.anchorX_, this.anchorY_, this.height_, this.opacity_, this.originX_, this.originY_, this.rotateWithView_, this.rotation_, this.scale_, this.width_, this.declutterImageWithText_]);\n    this.endGeometry(feature);\n  };\n  /**\n   * @return {import(\"../canvas.js\").SerializableInstructions} the serializable instructions.\n   */\n\n\n  CanvasImageBuilder.prototype.finish = function () {\n    this.reverseHitDetectionInstructions(); // FIXME this doesn't really protect us against further calls to draw*Geometry\n\n    this.anchorX_ = undefined;\n    this.anchorY_ = undefined;\n    this.hitDetectionImage_ = null;\n    this.image_ = null;\n    this.imagePixelRatio_ = undefined;\n    this.height_ = undefined;\n    this.scale_ = undefined;\n    this.opacity_ = undefined;\n    this.originX_ = undefined;\n    this.originY_ = undefined;\n    this.rotateWithView_ = undefined;\n    this.rotation_ = undefined;\n    this.width_ = undefined;\n    return _super.prototype.finish.call(this);\n  };\n  /**\n   * @param {import(\"../../style/Image.js\").default} imageStyle Image style.\n   * @param {Object} [opt_sharedData] Shared data.\n   */\n\n\n  CanvasImageBuilder.prototype.setImageStyle = function (imageStyle, opt_sharedData) {\n    var anchor = imageStyle.getAnchor();\n    var size = imageStyle.getSize();\n    var hitDetectionImage = imageStyle.getHitDetectionImage();\n    var image = imageStyle.getImage(this.pixelRatio);\n    var origin = imageStyle.getOrigin();\n    this.imagePixelRatio_ = imageStyle.getPixelRatio(this.pixelRatio);\n    this.anchorX_ = anchor[0];\n    this.anchorY_ = anchor[1];\n    this.hitDetectionImage_ = hitDetectionImage;\n    this.image_ = image;\n    this.height_ = size[1];\n    this.opacity_ = imageStyle.getOpacity();\n    this.originX_ = origin[0] * this.imagePixelRatio_;\n    this.originY_ = origin[1] * this.imagePixelRatio_;\n    this.rotateWithView_ = imageStyle.getRotateWithView();\n    this.rotation_ = imageStyle.getRotation();\n    this.scale_ = imageStyle.getScaleArray();\n    this.width_ = size[0];\n    this.declutterImageWithText_ = opt_sharedData;\n  };\n\n  return CanvasImageBuilder;\n}(CanvasBuilder);\n\nexport default CanvasImageBuilder;","map":{"version":3,"sources":["C:/Users/admin/Downloads/igo2-lib-master/igo2-lib-master/node_modules/ol/render/canvas/ImageBuilder.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","prototype","hasOwnProperty","call","TypeError","String","__","constructor","create","CanvasBuilder","CanvasInstruction","CanvasImageBuilder","_super","tolerance","maxExtent","resolution","pixelRatio","_this","hitDetectionImage_","image_","imagePixelRatio_","undefined","anchorX_","anchorY_","height_","opacity_","originX_","originY_","rotateWithView_","rotation_","scale_","width_","declutterImageWithText_","drawPoint","pointGeometry","feature","beginGeometry","flatCoordinates","getFlatCoordinates","stride","getStride","myBegin","coordinates","length","myEnd","appendFlatPointCoordinates","instructions","push","DRAW_IMAGE","Math","ceil","hitDetectionInstructions","endGeometry","drawMultiPoint","multiPointGeometry","finish","reverseHitDetectionInstructions","setImageStyle","imageStyle","opt_sharedData","anchor","getAnchor","size","getSize","hitDetectionImage","getHitDetectionImage","image","getImage","origin","getOrigin","getPixelRatio","getOpacity","getRotateWithView","getRotation","getScaleArray"],"mappings":"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","sourcesContent":["var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n/**\n * @module ol/render/canvas/ImageBuilder\n */\nimport CanvasBuilder from './Builder.js';\nimport CanvasInstruction from './Instruction.js';\nvar CanvasImageBuilder = /** @class */ (function (_super) {\n    __extends(CanvasImageBuilder, _super);\n    /**\n     * @param {number} tolerance Tolerance.\n     * @param {import(\"../../extent.js\").Extent} maxExtent Maximum extent.\n     * @param {number} resolution Resolution.\n     * @param {number} pixelRatio Pixel ratio.\n     */\n    function CanvasImageBuilder(tolerance, maxExtent, resolution, pixelRatio) {\n        var _this = _super.call(this, tolerance, maxExtent, resolution, pixelRatio) || this;\n        /**\n         * @private\n         * @type {HTMLCanvasElement|HTMLVideoElement|HTMLImageElement}\n         */\n        _this.hitDetectionImage_ = null;\n        /**\n         * @private\n         * @type {HTMLCanvasElement|HTMLVideoElement|HTMLImageElement}\n         */\n        _this.image_ = null;\n        /**\n         * @private\n         * @type {number|undefined}\n         */\n        _this.imagePixelRatio_ = undefined;\n        /**\n         * @private\n         * @type {number|undefined}\n         */\n        _this.anchorX_ = undefined;\n        /**\n         * @private\n         * @type {number|undefined}\n         */\n        _this.anchorY_ = undefined;\n        /**\n         * @private\n         * @type {number|undefined}\n         */\n        _this.height_ = undefined;\n        /**\n         * @private\n         * @type {number|undefined}\n         */\n        _this.opacity_ = undefined;\n        /**\n         * @private\n         * @type {number|undefined}\n         */\n        _this.originX_ = undefined;\n        /**\n         * @private\n         * @type {number|undefined}\n         */\n        _this.originY_ = undefined;\n        /**\n         * @private\n         * @type {boolean|undefined}\n         */\n        _this.rotateWithView_ = undefined;\n        /**\n         * @private\n         * @type {number|undefined}\n         */\n        _this.rotation_ = undefined;\n        /**\n         * @private\n         * @type {import(\"../../size.js\").Size|undefined}\n         */\n        _this.scale_ = undefined;\n        /**\n         * @private\n         * @type {number|undefined}\n         */\n        _this.width_ = undefined;\n        /**\n         * Data shared with a text builder for combined decluttering.\n         * @private\n         * @type {import(\"../canvas.js\").DeclutterImageWithText}\n         */\n        _this.declutterImageWithText_ = undefined;\n        return _this;\n    }\n    /**\n     * @param {import(\"../../geom/Point.js\").default|import(\"../Feature.js\").default} pointGeometry Point geometry.\n     * @param {import(\"../../Feature.js\").FeatureLike} feature Feature.\n     */\n    CanvasImageBuilder.prototype.drawPoint = function (pointGeometry, feature) {\n        if (!this.image_) {\n            return;\n        }\n        this.beginGeometry(pointGeometry, feature);\n        var flatCoordinates = pointGeometry.getFlatCoordinates();\n        var stride = pointGeometry.getStride();\n        var myBegin = this.coordinates.length;\n        var myEnd = this.appendFlatPointCoordinates(flatCoordinates, stride);\n        this.instructions.push([\n            CanvasInstruction.DRAW_IMAGE,\n            myBegin,\n            myEnd,\n            this.image_,\n            // Remaining arguments to DRAW_IMAGE are in alphabetical order\n            this.anchorX_ * this.imagePixelRatio_,\n            this.anchorY_ * this.imagePixelRatio_,\n            Math.ceil(this.height_ * this.imagePixelRatio_),\n            this.opacity_,\n            this.originX_,\n            this.originY_,\n            this.rotateWithView_,\n            this.rotation_,\n            [\n                (this.scale_[0] * this.pixelRatio) / this.imagePixelRatio_,\n                (this.scale_[1] * this.pixelRatio) / this.imagePixelRatio_,\n            ],\n            Math.ceil(this.width_ * this.imagePixelRatio_),\n            this.declutterImageWithText_,\n        ]);\n        this.hitDetectionInstructions.push([\n            CanvasInstruction.DRAW_IMAGE,\n            myBegin,\n            myEnd,\n            this.hitDetectionImage_,\n            // Remaining arguments to DRAW_IMAGE are in alphabetical order\n            this.anchorX_,\n            this.anchorY_,\n            this.height_,\n            this.opacity_,\n            this.originX_,\n            this.originY_,\n            this.rotateWithView_,\n            this.rotation_,\n            this.scale_,\n            this.width_,\n            this.declutterImageWithText_,\n        ]);\n        this.endGeometry(feature);\n    };\n    /**\n     * @param {import(\"../../geom/MultiPoint.js\").default|import(\"../Feature.js\").default} multiPointGeometry MultiPoint geometry.\n     * @param {import(\"../../Feature.js\").FeatureLike} feature Feature.\n     */\n    CanvasImageBuilder.prototype.drawMultiPoint = function (multiPointGeometry, feature) {\n        if (!this.image_) {\n            return;\n        }\n        this.beginGeometry(multiPointGeometry, feature);\n        var flatCoordinates = multiPointGeometry.getFlatCoordinates();\n        var stride = multiPointGeometry.getStride();\n        var myBegin = this.coordinates.length;\n        var myEnd = this.appendFlatPointCoordinates(flatCoordinates, stride);\n        this.instructions.push([\n            CanvasInstruction.DRAW_IMAGE,\n            myBegin,\n            myEnd,\n            this.image_,\n            // Remaining arguments to DRAW_IMAGE are in alphabetical order\n            this.anchorX_ * this.imagePixelRatio_,\n            this.anchorY_ * this.imagePixelRatio_,\n            Math.ceil(this.height_ * this.imagePixelRatio_),\n            this.opacity_,\n            this.originX_,\n            this.originY_,\n            this.rotateWithView_,\n            this.rotation_,\n            [\n                (this.scale_[0] * this.pixelRatio) / this.imagePixelRatio_,\n                (this.scale_[1] * this.pixelRatio) / this.imagePixelRatio_,\n            ],\n            Math.ceil(this.width_ * this.imagePixelRatio_),\n            this.declutterImageWithText_,\n        ]);\n        this.hitDetectionInstructions.push([\n            CanvasInstruction.DRAW_IMAGE,\n            myBegin,\n            myEnd,\n            this.hitDetectionImage_,\n            // Remaining arguments to DRAW_IMAGE are in alphabetical order\n            this.anchorX_,\n            this.anchorY_,\n            this.height_,\n            this.opacity_,\n            this.originX_,\n            this.originY_,\n            this.rotateWithView_,\n            this.rotation_,\n            this.scale_,\n            this.width_,\n            this.declutterImageWithText_,\n        ]);\n        this.endGeometry(feature);\n    };\n    /**\n     * @return {import(\"../canvas.js\").SerializableInstructions} the serializable instructions.\n     */\n    CanvasImageBuilder.prototype.finish = function () {\n        this.reverseHitDetectionInstructions();\n        // FIXME this doesn't really protect us against further calls to draw*Geometry\n        this.anchorX_ = undefined;\n        this.anchorY_ = undefined;\n        this.hitDetectionImage_ = null;\n        this.image_ = null;\n        this.imagePixelRatio_ = undefined;\n        this.height_ = undefined;\n        this.scale_ = undefined;\n        this.opacity_ = undefined;\n        this.originX_ = undefined;\n        this.originY_ = undefined;\n        this.rotateWithView_ = undefined;\n        this.rotation_ = undefined;\n        this.width_ = undefined;\n        return _super.prototype.finish.call(this);\n    };\n    /**\n     * @param {import(\"../../style/Image.js\").default} imageStyle Image style.\n     * @param {Object} [opt_sharedData] Shared data.\n     */\n    CanvasImageBuilder.prototype.setImageStyle = function (imageStyle, opt_sharedData) {\n        var anchor = imageStyle.getAnchor();\n        var size = imageStyle.getSize();\n        var hitDetectionImage = imageStyle.getHitDetectionImage();\n        var image = imageStyle.getImage(this.pixelRatio);\n        var origin = imageStyle.getOrigin();\n        this.imagePixelRatio_ = imageStyle.getPixelRatio(this.pixelRatio);\n        this.anchorX_ = anchor[0];\n        this.anchorY_ = anchor[1];\n        this.hitDetectionImage_ = hitDetectionImage;\n        this.image_ = image;\n        this.height_ = size[1];\n        this.opacity_ = imageStyle.getOpacity();\n        this.originX_ = origin[0] * this.imagePixelRatio_;\n        this.originY_ = origin[1] * this.imagePixelRatio_;\n        this.rotateWithView_ = imageStyle.getRotateWithView();\n        this.rotation_ = imageStyle.getRotation();\n        this.scale_ = imageStyle.getScaleArray();\n        this.width_ = size[0];\n        this.declutterImageWithText_ = opt_sharedData;\n    };\n    return CanvasImageBuilder;\n}(CanvasBuilder));\nexport default CanvasImageBuilder;\n"]},"metadata":{},"sourceType":"module"}